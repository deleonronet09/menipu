source file: <b>/root/buildbot/sandbox/lib/python2.7/site-packages/jinja2/tests.py</b><br>


file stats: <b>68 lines, 43 executed: 63.2% covered</b>
<pre>
<font color="black">   1. # -*- coding: utf-8 -*-</font>
<font color="black">   2. &quot;&quot;&quot;</font>
<font color="black">   3.     jinja2.tests</font>
<font color="black">   4.     ~~~~~~~~~~~~</font>
<font color="black">   5. </font>
<font color="black">   6.     Jinja test functions. Used with the &quot;is&quot; operator.</font>
<font color="black">   7. </font>
<font color="black">   8.     :copyright: (c) 2010 by the Jinja Team.</font>
<font color="black">   9.     :license: BSD, see LICENSE for more details.</font>
<font color="green">  10. &quot;&quot;&quot;</font>
<font color="green">  11. import re</font>
<font color="green">  12. from collections import Mapping</font>
<font color="green">  13. from jinja2.runtime import Undefined</font>
<font color="green">  14. from jinja2._compat import text_type, string_types, integer_types</font>
<font color="green">  15. import decimal</font>
<font color="black">  16. </font>
<font color="green">  17. number_re = re.compile(r'^-?\d+(\.\d+)?$')</font>
<font color="green">  18. regex_type = type(number_re)</font>
<font color="black">  19. </font>
<font color="black">  20. </font>
<font color="green">  21. test_callable = callable</font>
<font color="black">  22. </font>
<font color="black">  23. </font>
<font color="green">  24. def test_odd(value):</font>
<font color="black">  25.     &quot;&quot;&quot;Return true if the variable is odd.&quot;&quot;&quot;</font>
<font color="red">  26.     return value % 2 == 1</font>
<font color="black">  27. </font>
<font color="black">  28. </font>
<font color="green">  29. def test_even(value):</font>
<font color="black">  30.     &quot;&quot;&quot;Return true if the variable is even.&quot;&quot;&quot;</font>
<font color="red">  31.     return value % 2 == 0</font>
<font color="black">  32. </font>
<font color="black">  33. </font>
<font color="green">  34. def test_divisibleby(value, num):</font>
<font color="black">  35.     &quot;&quot;&quot;Check if a variable is divisible by a number.&quot;&quot;&quot;</font>
<font color="red">  36.     return value % num == 0</font>
<font color="black">  37. </font>
<font color="black">  38. </font>
<font color="green">  39. def test_defined(value):</font>
<font color="black">  40.     &quot;&quot;&quot;Return true if the variable is defined:</font>
<font color="black">  41. </font>
<font color="black">  42.     .. sourcecode:: jinja</font>
<font color="black">  43. </font>
<font color="black">  44.         {% if variable is defined %}</font>
<font color="black">  45.             value of variable: {{ variable }}</font>
<font color="black">  46.         {% else %}</font>
<font color="black">  47.             variable is not defined</font>
<font color="black">  48.         {% endif %}</font>
<font color="black">  49. </font>
<font color="black">  50.     See the :func:`default` filter for a simple way to set undefined</font>
<font color="black">  51.     variables.</font>
<font color="black">  52.     &quot;&quot;&quot;</font>
<font color="red">  53.     return not isinstance(value, Undefined)</font>
<font color="black">  54. </font>
<font color="black">  55. </font>
<font color="green">  56. def test_undefined(value):</font>
<font color="black">  57.     &quot;&quot;&quot;Like :func:`defined` but the other way round.&quot;&quot;&quot;</font>
<font color="red">  58.     return isinstance(value, Undefined)</font>
<font color="black">  59. </font>
<font color="black">  60. </font>
<font color="green">  61. def test_none(value):</font>
<font color="black">  62.     &quot;&quot;&quot;Return true if the variable is none.&quot;&quot;&quot;</font>
<font color="red">  63.     return value is None</font>
<font color="black">  64. </font>
<font color="black">  65. </font>
<font color="green">  66. def test_lower(value):</font>
<font color="black">  67.     &quot;&quot;&quot;Return true if the variable is lowercased.&quot;&quot;&quot;</font>
<font color="red">  68.     return text_type(value).islower()</font>
<font color="black">  69. </font>
<font color="black">  70. </font>
<font color="green">  71. def test_upper(value):</font>
<font color="black">  72.     &quot;&quot;&quot;Return true if the variable is uppercased.&quot;&quot;&quot;</font>
<font color="red">  73.     return text_type(value).isupper()</font>
<font color="black">  74. </font>
<font color="black">  75. </font>
<font color="green">  76. def test_string(value):</font>
<font color="black">  77.     &quot;&quot;&quot;Return true if the object is a string.&quot;&quot;&quot;</font>
<font color="red">  78.     return isinstance(value, string_types)</font>
<font color="black">  79. </font>
<font color="black">  80. </font>
<font color="green">  81. def test_mapping(value):</font>
<font color="black">  82.     &quot;&quot;&quot;Return true if the object is a mapping (dict etc.).</font>
<font color="black">  83. </font>
<font color="black">  84.     .. versionadded:: 2.6</font>
<font color="black">  85.     &quot;&quot;&quot;</font>
<font color="red">  86.     return isinstance(value, Mapping)</font>
<font color="black">  87. </font>
<font color="black">  88. </font>
<font color="green">  89. def test_number(value):</font>
<font color="black">  90.     &quot;&quot;&quot;Return true if the variable is a number.&quot;&quot;&quot;</font>
<font color="red">  91.     return isinstance(value, integer_types + (float, complex, decimal.Decimal))</font>
<font color="black">  92. </font>
<font color="black">  93. </font>
<font color="green">  94. def test_sequence(value):</font>
<font color="black">  95.     &quot;&quot;&quot;Return true if the variable is a sequence. Sequences are variables</font>
<font color="black">  96.     that are iterable.</font>
<font color="black">  97.     &quot;&quot;&quot;</font>
<font color="red">  98.     try:</font>
<font color="red">  99.         len(value)</font>
<font color="red"> 100.         value.__getitem__</font>
<font color="red"> 101.     except:</font>
<font color="red"> 102.         return False</font>
<font color="red"> 103.     return True</font>
<font color="black"> 104. </font>
<font color="black"> 105. </font>
<font color="green"> 106. def test_equalto(value, other):</font>
<font color="black"> 107.     &quot;&quot;&quot;Check if an object has the same value as another object:</font>
<font color="black"> 108. </font>
<font color="black"> 109.     .. sourcecode:: jinja</font>
<font color="black"> 110. </font>
<font color="black"> 111.         {% if foo.expression is equalto 42 %}</font>
<font color="black"> 112.             the foo attribute evaluates to the constant 42</font>
<font color="black"> 113.         {% endif %}</font>
<font color="black"> 114. </font>
<font color="black"> 115.     This appears to be a useless test as it does exactly the same as the</font>
<font color="black"> 116.     ``==`` operator, but it can be useful when used together with the</font>
<font color="black"> 117.     `selectattr` function:</font>
<font color="black"> 118. </font>
<font color="black"> 119.     .. sourcecode:: jinja</font>
<font color="black"> 120. </font>
<font color="black"> 121.         {{ users|selectattr(&quot;email&quot;, &quot;equalto&quot;, &quot;foo@bar.invalid&quot;) }}</font>
<font color="black"> 122. </font>
<font color="black"> 123.     .. versionadded:: 2.8</font>
<font color="black"> 124.     &quot;&quot;&quot;</font>
<font color="red"> 125.     return value == other</font>
<font color="black"> 126. </font>
<font color="black"> 127. </font>
<font color="green"> 128. def test_sameas(value, other):</font>
<font color="black"> 129.     &quot;&quot;&quot;Check if an object points to the same memory address than another</font>
<font color="black"> 130.     object:</font>
<font color="black"> 131. </font>
<font color="black"> 132.     .. sourcecode:: jinja</font>
<font color="black"> 133. </font>
<font color="black"> 134.         {% if foo.attribute is sameas false %}</font>
<font color="black"> 135.             the foo attribute really is the `False` singleton</font>
<font color="black"> 136.         {% endif %}</font>
<font color="black"> 137.     &quot;&quot;&quot;</font>
<font color="red"> 138.     return value is other</font>
<font color="black"> 139. </font>
<font color="black"> 140. </font>
<font color="green"> 141. def test_iterable(value):</font>
<font color="black"> 142.     &quot;&quot;&quot;Check if it's possible to iterate over an object.&quot;&quot;&quot;</font>
<font color="red"> 143.     try:</font>
<font color="red"> 144.         iter(value)</font>
<font color="red"> 145.     except TypeError:</font>
<font color="red"> 146.         return False</font>
<font color="red"> 147.     return True</font>
<font color="black"> 148. </font>
<font color="black"> 149. </font>
<font color="green"> 150. def test_escaped(value):</font>
<font color="black"> 151.     &quot;&quot;&quot;Check if the value is escaped.&quot;&quot;&quot;</font>
<font color="red"> 152.     return hasattr(value, '__html__')</font>
<font color="black"> 153. </font>
<font color="black"> 154. </font>
<font color="green"> 155. TESTS = {</font>
<font color="green"> 156.     'odd':              test_odd,</font>
<font color="green"> 157.     'even':             test_even,</font>
<font color="green"> 158.     'divisibleby':      test_divisibleby,</font>
<font color="green"> 159.     'defined':          test_defined,</font>
<font color="green"> 160.     'undefined':        test_undefined,</font>
<font color="green"> 161.     'none':             test_none,</font>
<font color="green"> 162.     'lower':            test_lower,</font>
<font color="green"> 163.     'upper':            test_upper,</font>
<font color="green"> 164.     'string':           test_string,</font>
<font color="green"> 165.     'mapping':          test_mapping,</font>
<font color="green"> 166.     'number':           test_number,</font>
<font color="green"> 167.     'sequence':         test_sequence,</font>
<font color="green"> 168.     'iterable':         test_iterable,</font>
<font color="green"> 169.     'callable':         test_callable,</font>
<font color="green"> 170.     'sameas':           test_sameas,</font>
<font color="green"> 171.     'equalto':          test_equalto,</font>
<font color="green"> 172.     'escaped':          test_escaped</font>
<font color="black"> 173. }</font>
</pre>

