source file: <b>/root/buildbot/sandbox/lib/python2.7/site-packages/django/conf/urls/__init__.py</b><br>


file stats: <b>71 lines, 14 executed: 19.7% covered</b>
<pre>
<font color="green">   1. import warnings</font>
<font color="green">   2. from importlib import import_module</font>
<font color="black">   3. </font>
<font color="green">   4. from django.core.exceptions import ImproperlyConfigured</font>
<font color="green">   5. from django.core.urlresolvers import (</font>
<font color="black">   6.     LocaleRegexURLResolver, RegexURLPattern, RegexURLResolver,</font>
<font color="black">   7. )</font>
<font color="green">   8. from django.utils import six</font>
<font color="green">   9. from django.utils.deprecation import (</font>
<font color="black">  10.     RemovedInDjango20Warning, RemovedInDjango110Warning,</font>
<font color="black">  11. )</font>
<font color="black">  12. </font>
<font color="green">  13. __all__ = ['handler400', 'handler403', 'handler404', 'handler500', 'include', 'patterns', 'url']</font>
<font color="black">  14. </font>
<font color="green">  15. handler400 = 'django.views.defaults.bad_request'</font>
<font color="green">  16. handler403 = 'django.views.defaults.permission_denied'</font>
<font color="green">  17. handler404 = 'django.views.defaults.page_not_found'</font>
<font color="green">  18. handler500 = 'django.views.defaults.server_error'</font>
<font color="black">  19. </font>
<font color="black">  20. </font>
<font color="green">  21. def include(arg, namespace=None, app_name=None):</font>
<font color="red">  22.     if app_name and not namespace:</font>
<font color="red">  23.         raise ValueError('Must specify a namespace if specifying app_name.')</font>
<font color="red">  24.     if app_name:</font>
<font color="red">  25.         warnings.warn(</font>
<font color="red">  26.             'The app_name argument to django.conf.urls.include() is deprecated. '</font>
<font color="black">  27.             'Set the app_name in the included URLconf instead.',</font>
<font color="red">  28.             RemovedInDjango20Warning, stacklevel=2</font>
<font color="black">  29.         )</font>
<font color="black">  30. </font>
<font color="red">  31.     if isinstance(arg, tuple):</font>
<font color="black">  32.         # callable returning a namespace hint</font>
<font color="red">  33.         try:</font>
<font color="red">  34.             urlconf_module, app_name = arg</font>
<font color="red">  35.         except ValueError:</font>
<font color="red">  36.             if namespace:</font>
<font color="red">  37.                 raise ImproperlyConfigured(</font>
<font color="red">  38.                     'Cannot override the namespace for a dynamic module that provides a namespace'</font>
<font color="black">  39.                 )</font>
<font color="red">  40.             warnings.warn(</font>
<font color="red">  41.                 'Passing a 3-tuple to django.conf.urls.include() is deprecated. '</font>
<font color="black">  42.                 'Pass a 2-tuple containing the list of patterns and app_name, '</font>
<font color="black">  43.                 'and provide the namespace argument to include() instead.',</font>
<font color="red">  44.                 RemovedInDjango20Warning, stacklevel=2</font>
<font color="black">  45.             )</font>
<font color="red">  46.             urlconf_module, app_name, namespace = arg</font>
<font color="black">  47.     else:</font>
<font color="black">  48.         # No namespace hint - use manually provided namespace</font>
<font color="red">  49.         urlconf_module = arg</font>
<font color="black">  50. </font>
<font color="red">  51.     if isinstance(urlconf_module, six.string_types):</font>
<font color="red">  52.         urlconf_module = import_module(urlconf_module)</font>
<font color="red">  53.     patterns = getattr(urlconf_module, 'urlpatterns', urlconf_module)</font>
<font color="red">  54.     app_name = getattr(urlconf_module, 'app_name', app_name)</font>
<font color="red">  55.     if namespace and not app_name:</font>
<font color="red">  56.         warnings.warn(</font>
<font color="red">  57.             'Specifying a namespace in django.conf.urls.include() without '</font>
<font color="black">  58.             'providing an app_name is deprecated. Set the app_name attribute '</font>
<font color="black">  59.             'in the included module, or pass a 2-tuple containing the list of '</font>
<font color="black">  60.             'patterns and app_name instead.',</font>
<font color="red">  61.             RemovedInDjango20Warning, stacklevel=2</font>
<font color="black">  62.         )</font>
<font color="black">  63. </font>
<font color="red">  64.     namespace = namespace or app_name</font>
<font color="black">  65. </font>
<font color="black">  66.     # Make sure we can iterate through the patterns (without this, some</font>
<font color="black">  67.     # testcases will break).</font>
<font color="red">  68.     if isinstance(patterns, (list, tuple)):</font>
<font color="red">  69.         for url_pattern in patterns:</font>
<font color="black">  70.             # Test if the LocaleRegexURLResolver is used within the include;</font>
<font color="black">  71.             # this should throw an error since this is not allowed!</font>
<font color="red">  72.             if isinstance(url_pattern, LocaleRegexURLResolver):</font>
<font color="red">  73.                 raise ImproperlyConfigured(</font>
<font color="red">  74.                     'Using i18n_patterns in an included URLconf is not allowed.')</font>
<font color="black">  75. </font>
<font color="red">  76.     return (urlconf_module, app_name, namespace)</font>
<font color="black">  77. </font>
<font color="black">  78. </font>
<font color="green">  79. def patterns(prefix, *args):</font>
<font color="red">  80.     warnings.warn(</font>
<font color="red">  81.         'django.conf.urls.patterns() is deprecated and will be removed in '</font>
<font color="black">  82.         'Django 1.10. Update your urlpatterns to be a list of '</font>
<font color="black">  83.         'django.conf.urls.url() instances instead.',</font>
<font color="red">  84.         RemovedInDjango110Warning, stacklevel=2</font>
<font color="black">  85.     )</font>
<font color="red">  86.     pattern_list = []</font>
<font color="red">  87.     for t in args:</font>
<font color="red">  88.         if isinstance(t, (list, tuple)):</font>
<font color="red">  89.             t = url(prefix=prefix, *t)</font>
<font color="red">  90.         elif isinstance(t, RegexURLPattern):</font>
<font color="red">  91.             t.add_prefix(prefix)</font>
<font color="red">  92.         pattern_list.append(t)</font>
<font color="red">  93.     return pattern_list</font>
<font color="black">  94. </font>
<font color="black">  95. </font>
<font color="green">  96. def url(regex, view, kwargs=None, name=None, prefix=''):</font>
<font color="red">  97.     if isinstance(view, (list, tuple)):</font>
<font color="black">  98.         # For include(...) processing.</font>
<font color="red">  99.         urlconf_module, app_name, namespace = view</font>
<font color="red"> 100.         return RegexURLResolver(regex, urlconf_module, kwargs, app_name=app_name, namespace=namespace)</font>
<font color="black"> 101.     else:</font>
<font color="red"> 102.         if isinstance(view, six.string_types):</font>
<font color="red"> 103.             warnings.warn(</font>
<font color="red"> 104.                 'Support for string view arguments to url() is deprecated and '</font>
<font color="black"> 105.                 'will be removed in Django 1.10 (got %s). Pass the callable '</font>
<font color="red"> 106.                 'instead.' % view,</font>
<font color="red"> 107.                 RemovedInDjango110Warning, stacklevel=2</font>
<font color="black"> 108.             )</font>
<font color="red"> 109.             if not view:</font>
<font color="red"> 110.                 raise ImproperlyConfigured('Empty URL pattern view name not permitted (for pattern %r)' % regex)</font>
<font color="red"> 111.             if prefix:</font>
<font color="red"> 112.                 view = prefix + '.' + view</font>
<font color="red"> 113.         return RegexURLPattern(regex, view, kwargs, name)</font>
</pre>

