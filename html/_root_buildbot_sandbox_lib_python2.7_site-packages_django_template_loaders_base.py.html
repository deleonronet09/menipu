source file: <b>/root/buildbot/sandbox/lib/python2.7/site-packages/django/template/loaders/base.py</b><br>


file stats: <b>52 lines, 14 executed: 26.9% covered</b>
<pre>
<font color="green">   1. import warnings</font>
<font color="black">   2. </font>
<font color="green">   3. from django.template import Origin, Template, TemplateDoesNotExist</font>
<font color="green">   4. from django.utils.deprecation import RemovedInDjango20Warning</font>
<font color="green">   5. from django.utils.inspect import func_supports_parameter</font>
<font color="black">   6. </font>
<font color="black">   7. </font>
<font color="green">   8. class Loader(object):</font>
<font color="black">   9.     # Only used to raise a deprecation warning. Remove in Django 1.10.</font>
<font color="green">  10.     _accepts_engine_in_init = True</font>
<font color="black">  11. </font>
<font color="green">  12.     def __init__(self, engine):</font>
<font color="red">  13.         self.engine = engine</font>
<font color="black">  14. </font>
<font color="green">  15.     def __call__(self, template_name, template_dirs=None):</font>
<font color="black">  16.         # RemovedInDjango20Warning: Allow loaders to be called like functions.</font>
<font color="red">  17.         return self.load_template(template_name, template_dirs)</font>
<font color="black">  18. </font>
<font color="green">  19.     def get_template(self, template_name, template_dirs=None, skip=None):</font>
<font color="black">  20.         &quot;&quot;&quot;</font>
<font color="black">  21.         Calls self.get_template_sources() and returns a Template object for</font>
<font color="black">  22.         the first template matching template_name. If skip is provided,</font>
<font color="black">  23.         template origins in skip are ignored. This is used to avoid recursion</font>
<font color="black">  24.         during template extending.</font>
<font color="black">  25.         &quot;&quot;&quot;</font>
<font color="red">  26.         tried = []</font>
<font color="black">  27. </font>
<font color="red">  28.         args = [template_name]</font>
<font color="black">  29.         # RemovedInDjango20Warning: Add template_dirs for compatibility with</font>
<font color="black">  30.         # old loaders</font>
<font color="red">  31.         if func_supports_parameter(self.get_template_sources, 'template_dirs'):</font>
<font color="red">  32.             args.append(template_dirs)</font>
<font color="black">  33. </font>
<font color="red">  34.         for origin in self.get_template_sources(*args):</font>
<font color="red">  35.             if skip is not None and origin in skip:</font>
<font color="red">  36.                 tried.append((origin, 'Skipped'))</font>
<font color="red">  37.                 continue</font>
<font color="black">  38. </font>
<font color="red">  39.             try:</font>
<font color="red">  40.                 contents = self.get_contents(origin)</font>
<font color="red">  41.             except TemplateDoesNotExist:</font>
<font color="red">  42.                 tried.append((origin, 'Source does not exist'))</font>
<font color="red">  43.                 continue</font>
<font color="black">  44.             else:</font>
<font color="red">  45.                 return Template(</font>
<font color="red">  46.                     contents, origin, origin.template_name, self.engine,</font>
<font color="black">  47.                 )</font>
<font color="black">  48. </font>
<font color="red">  49.         raise TemplateDoesNotExist(template_name, tried=tried)</font>
<font color="black">  50. </font>
<font color="green">  51.     def load_template(self, template_name, template_dirs=None):</font>
<font color="red">  52.         warnings.warn(</font>
<font color="red">  53.             'The load_template() method is deprecated. Use get_template() '</font>
<font color="red">  54.             'instead.', RemovedInDjango20Warning,</font>
<font color="black">  55.         )</font>
<font color="red">  56.         source, display_name = self.load_template_source(</font>
<font color="red">  57.             template_name, template_dirs,</font>
<font color="black">  58.         )</font>
<font color="red">  59.         origin = Origin(</font>
<font color="red">  60.             name=display_name,</font>
<font color="red">  61.             template_name=template_name,</font>
<font color="red">  62.             loader=self,</font>
<font color="black">  63.         )</font>
<font color="red">  64.         try:</font>
<font color="red">  65.             template = Template(source, origin, template_name, self.engine)</font>
<font color="red">  66.         except TemplateDoesNotExist:</font>
<font color="black">  67.             # If compiling the template we found raises TemplateDoesNotExist,</font>
<font color="black">  68.             # back off to returning the source and display name for the</font>
<font color="black">  69.             # template we were asked to load. This allows for correct</font>
<font color="black">  70.             # identification of the actual template that does not exist.</font>
<font color="red">  71.             return source, display_name</font>
<font color="black">  72.         else:</font>
<font color="red">  73.             return template, None</font>
<font color="black">  74. </font>
<font color="green">  75.     def get_template_sources(self, template_name):</font>
<font color="black">  76.         &quot;&quot;&quot;</font>
<font color="black">  77.         An iterator that yields possible matching template paths for a</font>
<font color="black">  78.         template name.</font>
<font color="black">  79.         &quot;&quot;&quot;</font>
<font color="red">  80.         raise NotImplementedError(</font>
<font color="red">  81.             'subclasses of Loader must provide a get_template_sources() method'</font>
<font color="black">  82.         )</font>
<font color="black">  83. </font>
<font color="green">  84.     def load_template_source(self, template_name, template_dirs=None):</font>
<font color="black">  85.         &quot;&quot;&quot;</font>
<font color="black">  86.         RemovedInDjango20Warning: Returns a tuple containing the source and</font>
<font color="black">  87.         origin for the given template name.</font>
<font color="black">  88.         &quot;&quot;&quot;</font>
<font color="red">  89.         raise NotImplementedError(</font>
<font color="red">  90.             'subclasses of Loader must provide a load_template_source() method'</font>
<font color="black">  91.         )</font>
<font color="black">  92. </font>
<font color="green">  93.     def reset(self):</font>
<font color="black">  94.         &quot;&quot;&quot;</font>
<font color="black">  95.         Resets any state maintained by the loader instance (e.g. cached</font>
<font color="black">  96.         templates or cached loader modules).</font>
<font color="black">  97.         &quot;&quot;&quot;</font>
<font color="red">  98.         pass</font>
<font color="black">  99. </font>
<font color="green"> 100.     @property</font>
<font color="black"> 101.     def supports_recursion(self):</font>
<font color="black"> 102.         &quot;&quot;&quot;</font>
<font color="black"> 103.         RemovedInDjango20Warning: This is an internal property used by the</font>
<font color="black"> 104.         ExtendsNode during the deprecation of non-recursive loaders.</font>
<font color="black"> 105.         &quot;&quot;&quot;</font>
<font color="red"> 106.         return hasattr(self, 'get_contents')</font>
</pre>

