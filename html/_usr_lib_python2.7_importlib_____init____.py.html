source file: <b>/usr/lib/python2.7/importlib/__init__.py</b><br>


file stats: <b>24 lines, 19 executed: 79.2% covered</b>
<pre>
<font color="green">   1. &quot;&quot;&quot;Backport of importlib.import_module from 3.x.&quot;&quot;&quot;</font>
<font color="black">   2. # While not critical (and in no way guaranteed!), it would be nice to keep this</font>
<font color="black">   3. # code compatible with Python 2.3.</font>
<font color="green">   4. import sys</font>
<font color="black">   5. </font>
<font color="green">   6. def _resolve_name(name, package, level):</font>
<font color="black">   7.     &quot;&quot;&quot;Return the absolute name of the module to be imported.&quot;&quot;&quot;</font>
<font color="green">   8.     if not hasattr(package, 'rindex'):</font>
<font color="red">   9.         raise ValueError(&quot;'package' not set to a string&quot;)</font>
<font color="green">  10.     dot = len(package)</font>
<font color="green">  11.     for x in xrange(level, 1, -1):</font>
<font color="red">  12.         try:</font>
<font color="red">  13.             dot = package.rindex('.', 0, dot)</font>
<font color="red">  14.         except ValueError:</font>
<font color="red">  15.             raise ValueError(&quot;attempted relative import beyond top-level &quot;</font>
<font color="black">  16.                               &quot;package&quot;)</font>
<font color="green">  17.     return &quot;%s.%s&quot; % (package[:dot], name)</font>
<font color="black">  18. </font>
<font color="black">  19. </font>
<font color="green">  20. def import_module(name, package=None):</font>
<font color="black">  21.     &quot;&quot;&quot;Import a module.</font>
<font color="black">  22. </font>
<font color="black">  23.     The 'package' argument is required when performing a relative import. It</font>
<font color="black">  24.     specifies the package to use as the anchor point from which to resolve the</font>
<font color="black">  25.     relative import to an absolute import.</font>
<font color="black">  26. </font>
<font color="black">  27.     &quot;&quot;&quot;</font>
<font color="green">  28.     if name.startswith('.'):</font>
<font color="green">  29.         if not package:</font>
<font color="green">  30.             raise TypeError(&quot;relative imports require the 'package' argument&quot;)</font>
<font color="green">  31.         level = 0</font>
<font color="green">  32.         for character in name:</font>
<font color="green">  33.             if character != '.':</font>
<font color="green">  34.                 break</font>
<font color="green">  35.             level += 1</font>
<font color="green">  36.         name = _resolve_name(name[level:], package, level)</font>
<font color="green">  37.     __import__(name)</font>
<font color="green">  38.     return sys.modules[name]</font>
</pre>

