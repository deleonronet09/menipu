source file: <b>/usr/lib/python2.7/xml/sax/handler.py</b><br>


file stats: <b>60 lines, 54 executed: 90.0% covered</b>
<pre>
<font color="black">   1. &quot;&quot;&quot;</font>
<font color="black">   2. This module contains the core classes of version 2.0 of SAX for Python.</font>
<font color="black">   3. This file provides only default classes with absolutely minimum</font>
<font color="black">   4. functionality, from which drivers and applications can be subclassed.</font>
<font color="black">   5. </font>
<font color="black">   6. Many of these classes are empty and are included only as documentation</font>
<font color="black">   7. of the interfaces.</font>
<font color="black">   8. </font>
<font color="black">   9. $Id$</font>
<font color="green">  10. &quot;&quot;&quot;</font>
<font color="black">  11. </font>
<font color="green">  12. version = '2.0beta'</font>
<font color="black">  13. </font>
<font color="black">  14. #============================================================================</font>
<font color="black">  15. #</font>
<font color="black">  16. # HANDLER INTERFACES</font>
<font color="black">  17. #</font>
<font color="black">  18. #============================================================================</font>
<font color="black">  19. </font>
<font color="black">  20. # ===== ERRORHANDLER =====</font>
<font color="black">  21. </font>
<font color="green">  22. class ErrorHandler:</font>
<font color="black">  23.     &quot;&quot;&quot;Basic interface for SAX error handlers.</font>
<font color="black">  24. </font>
<font color="black">  25.     If you create an object that implements this interface, then</font>
<font color="black">  26.     register the object with your XMLReader, the parser will call the</font>
<font color="black">  27.     methods in your object to report all warnings and errors. There</font>
<font color="black">  28.     are three levels of errors available: warnings, (possibly)</font>
<font color="black">  29.     recoverable errors, and unrecoverable errors. All methods take a</font>
<font color="green">  30.     SAXParseException as the only parameter.&quot;&quot;&quot;</font>
<font color="black">  31. </font>
<font color="green">  32.     def error(self, exception):</font>
<font color="black">  33.         &quot;Handle a recoverable error.&quot;</font>
<font color="red">  34.         raise exception</font>
<font color="black">  35. </font>
<font color="green">  36.     def fatalError(self, exception):</font>
<font color="black">  37.         &quot;Handle a non-recoverable error.&quot;</font>
<font color="red">  38.         raise exception</font>
<font color="black">  39. </font>
<font color="green">  40.     def warning(self, exception):</font>
<font color="black">  41.         &quot;Handle a warning.&quot;</font>
<font color="red">  42.         print exception</font>
<font color="black">  43. </font>
<font color="black">  44. </font>
<font color="black">  45. # ===== CONTENTHANDLER =====</font>
<font color="black">  46. </font>
<font color="green">  47. class ContentHandler:</font>
<font color="black">  48.     &quot;&quot;&quot;Interface for receiving logical document content events.</font>
<font color="black">  49. </font>
<font color="black">  50.     This is the main callback interface in SAX, and the one most</font>
<font color="black">  51.     important to applications. The order of events in this interface</font>
<font color="green">  52.     mirrors the order of the information in the document.&quot;&quot;&quot;</font>
<font color="black">  53. </font>
<font color="green">  54.     def __init__(self):</font>
<font color="red">  55.         self._locator = None</font>
<font color="black">  56. </font>
<font color="green">  57.     def setDocumentLocator(self, locator):</font>
<font color="black">  58.         &quot;&quot;&quot;Called by the parser to give the application a locator for</font>
<font color="black">  59.         locating the origin of document events.</font>
<font color="black">  60. </font>
<font color="black">  61.         SAX parsers are strongly encouraged (though not absolutely</font>
<font color="black">  62.         required) to supply a locator: if it does so, it must supply</font>
<font color="black">  63.         the locator to the application by invoking this method before</font>
<font color="black">  64.         invoking any of the other methods in the DocumentHandler</font>
<font color="black">  65.         interface.</font>
<font color="black">  66. </font>
<font color="black">  67.         The locator allows the application to determine the end</font>
<font color="black">  68.         position of any document-related event, even if the parser is</font>
<font color="black">  69.         not reporting an error. Typically, the application will use</font>
<font color="black">  70.         this information for reporting its own errors (such as</font>
<font color="black">  71.         character content that does not match an application's</font>
<font color="black">  72.         business rules). The information returned by the locator is</font>
<font color="black">  73.         probably not sufficient for use with a search engine.</font>
<font color="black">  74. </font>
<font color="black">  75.         Note that the locator will return correct information only</font>
<font color="black">  76.         during the invocation of the events in this interface. The</font>
<font color="black">  77.         application should not attempt to use it at any other time.&quot;&quot;&quot;</font>
<font color="red">  78.         self._locator = locator</font>
<font color="black">  79. </font>
<font color="green">  80.     def startDocument(self):</font>
<font color="black">  81.         &quot;&quot;&quot;Receive notification of the beginning of a document.</font>
<font color="black">  82. </font>
<font color="black">  83.         The SAX parser will invoke this method only once, before any</font>
<font color="black">  84.         other methods in this interface or in DTDHandler (except for</font>
<font color="black">  85.         setDocumentLocator).&quot;&quot;&quot;</font>
<font color="black">  86. </font>
<font color="green">  87.     def endDocument(self):</font>
<font color="black">  88.         &quot;&quot;&quot;Receive notification of the end of a document.</font>
<font color="black">  89. </font>
<font color="black">  90.         The SAX parser will invoke this method only once, and it will</font>
<font color="black">  91.         be the last method invoked during the parse. The parser shall</font>
<font color="black">  92.         not invoke this method until it has either abandoned parsing</font>
<font color="black">  93.         (because of an unrecoverable error) or reached the end of</font>
<font color="black">  94.         input.&quot;&quot;&quot;</font>
<font color="black">  95. </font>
<font color="green">  96.     def startPrefixMapping(self, prefix, uri):</font>
<font color="black">  97.         &quot;&quot;&quot;Begin the scope of a prefix-URI Namespace mapping.</font>
<font color="black">  98. </font>
<font color="black">  99.         The information from this event is not necessary for normal</font>
<font color="black"> 100.         Namespace processing: the SAX XML reader will automatically</font>
<font color="black"> 101.         replace prefixes for element and attribute names when the</font>
<font color="black"> 102.         http://xml.org/sax/features/namespaces feature is true (the</font>
<font color="black"> 103.         default).</font>
<font color="black"> 104. </font>
<font color="black"> 105.         There are cases, however, when applications need to use</font>
<font color="black"> 106.         prefixes in character data or in attribute values, where they</font>
<font color="black"> 107.         cannot safely be expanded automatically; the</font>
<font color="black"> 108.         start/endPrefixMapping event supplies the information to the</font>
<font color="black"> 109.         application to expand prefixes in those contexts itself, if</font>
<font color="black"> 110.         necessary.</font>
<font color="black"> 111. </font>
<font color="black"> 112.         Note that start/endPrefixMapping events are not guaranteed to</font>
<font color="black"> 113.         be properly nested relative to each-other: all</font>
<font color="black"> 114.         startPrefixMapping events will occur before the corresponding</font>
<font color="black"> 115.         startElement event, and all endPrefixMapping events will occur</font>
<font color="black"> 116.         after the corresponding endElement event, but their order is</font>
<font color="black"> 117.         not guaranteed.&quot;&quot;&quot;</font>
<font color="black"> 118. </font>
<font color="green"> 119.     def endPrefixMapping(self, prefix):</font>
<font color="black"> 120.         &quot;&quot;&quot;End the scope of a prefix-URI mapping.</font>
<font color="black"> 121. </font>
<font color="black"> 122.         See startPrefixMapping for details. This event will always</font>
<font color="black"> 123.         occur after the corresponding endElement event, but the order</font>
<font color="black"> 124.         of endPrefixMapping events is not otherwise guaranteed.&quot;&quot;&quot;</font>
<font color="black"> 125. </font>
<font color="green"> 126.     def startElement(self, name, attrs):</font>
<font color="black"> 127.         &quot;&quot;&quot;Signals the start of an element in non-namespace mode.</font>
<font color="black"> 128. </font>
<font color="black"> 129.         The name parameter contains the raw XML 1.0 name of the</font>
<font color="black"> 130.         element type as a string and the attrs parameter holds an</font>
<font color="black"> 131.         instance of the Attributes class containing the attributes of</font>
<font color="black"> 132.         the element.&quot;&quot;&quot;</font>
<font color="black"> 133. </font>
<font color="green"> 134.     def endElement(self, name):</font>
<font color="black"> 135.         &quot;&quot;&quot;Signals the end of an element in non-namespace mode.</font>
<font color="black"> 136. </font>
<font color="black"> 137.         The name parameter contains the name of the element type, just</font>
<font color="black"> 138.         as with the startElement event.&quot;&quot;&quot;</font>
<font color="black"> 139. </font>
<font color="green"> 140.     def startElementNS(self, name, qname, attrs):</font>
<font color="black"> 141.         &quot;&quot;&quot;Signals the start of an element in namespace mode.</font>
<font color="black"> 142. </font>
<font color="black"> 143.         The name parameter contains the name of the element type as a</font>
<font color="black"> 144.         (uri, localname) tuple, the qname parameter the raw XML 1.0</font>
<font color="black"> 145.         name used in the source document, and the attrs parameter</font>
<font color="black"> 146.         holds an instance of the Attributes class containing the</font>
<font color="black"> 147.         attributes of the element.</font>
<font color="black"> 148. </font>
<font color="black"> 149.         The uri part of the name tuple is None for elements which have</font>
<font color="black"> 150.         no namespace.&quot;&quot;&quot;</font>
<font color="black"> 151. </font>
<font color="green"> 152.     def endElementNS(self, name, qname):</font>
<font color="black"> 153.         &quot;&quot;&quot;Signals the end of an element in namespace mode.</font>
<font color="black"> 154. </font>
<font color="black"> 155.         The name parameter contains the name of the element type, just</font>
<font color="black"> 156.         as with the startElementNS event.&quot;&quot;&quot;</font>
<font color="black"> 157. </font>
<font color="green"> 158.     def characters(self, content):</font>
<font color="black"> 159.         &quot;&quot;&quot;Receive notification of character data.</font>
<font color="black"> 160. </font>
<font color="black"> 161.         The Parser will call this method to report each chunk of</font>
<font color="black"> 162.         character data. SAX parsers may return all contiguous</font>
<font color="black"> 163.         character data in a single chunk, or they may split it into</font>
<font color="black"> 164.         several chunks; however, all of the characters in any single</font>
<font color="black"> 165.         event must come from the same external entity so that the</font>
<font color="black"> 166.         Locator provides useful information.&quot;&quot;&quot;</font>
<font color="black"> 167. </font>
<font color="green"> 168.     def ignorableWhitespace(self, whitespace):</font>
<font color="black"> 169.         &quot;&quot;&quot;Receive notification of ignorable whitespace in element content.</font>
<font color="black"> 170. </font>
<font color="black"> 171.         Validating Parsers must use this method to report each chunk</font>
<font color="black"> 172.         of ignorable whitespace (see the W3C XML 1.0 recommendation,</font>
<font color="black"> 173.         section 2.10): non-validating parsers may also use this method</font>
<font color="black"> 174.         if they are capable of parsing and using content models.</font>
<font color="black"> 175. </font>
<font color="black"> 176.         SAX parsers may return all contiguous whitespace in a single</font>
<font color="black"> 177.         chunk, or they may split it into several chunks; however, all</font>
<font color="black"> 178.         of the characters in any single event must come from the same</font>
<font color="black"> 179.         external entity, so that the Locator provides useful</font>
<font color="black"> 180.         information.&quot;&quot;&quot;</font>
<font color="black"> 181. </font>
<font color="green"> 182.     def processingInstruction(self, target, data):</font>
<font color="black"> 183.         &quot;&quot;&quot;Receive notification of a processing instruction.</font>
<font color="black"> 184. </font>
<font color="black"> 185.         The Parser will invoke this method once for each processing</font>
<font color="black"> 186.         instruction found: note that processing instructions may occur</font>
<font color="black"> 187.         before or after the main document element.</font>
<font color="black"> 188. </font>
<font color="black"> 189.         A SAX parser should never report an XML declaration (XML 1.0,</font>
<font color="black"> 190.         section 2.8) or a text declaration (XML 1.0, section 4.3.1)</font>
<font color="black"> 191.         using this method.&quot;&quot;&quot;</font>
<font color="black"> 192. </font>
<font color="green"> 193.     def skippedEntity(self, name):</font>
<font color="black"> 194.         &quot;&quot;&quot;Receive notification of a skipped entity.</font>
<font color="black"> 195. </font>
<font color="black"> 196.         The Parser will invoke this method once for each entity</font>
<font color="black"> 197.         skipped. Non-validating processors may skip entities if they</font>
<font color="black"> 198.         have not seen the declarations (because, for example, the</font>
<font color="black"> 199.         entity was declared in an external DTD subset). All processors</font>
<font color="black"> 200.         may skip external entities, depending on the values of the</font>
<font color="black"> 201.         http://xml.org/sax/features/external-general-entities and the</font>
<font color="black"> 202.         http://xml.org/sax/features/external-parameter-entities</font>
<font color="black"> 203.         properties.&quot;&quot;&quot;</font>
<font color="black"> 204. </font>
<font color="black"> 205. </font>
<font color="black"> 206. # ===== DTDHandler =====</font>
<font color="black"> 207. </font>
<font color="green"> 208. class DTDHandler:</font>
<font color="black"> 209.     &quot;&quot;&quot;Handle DTD events.</font>
<font color="black"> 210. </font>
<font color="black"> 211.     This interface specifies only those DTD events required for basic</font>
<font color="green"> 212.     parsing (unparsed entities and attributes).&quot;&quot;&quot;</font>
<font color="black"> 213. </font>
<font color="green"> 214.     def notationDecl(self, name, publicId, systemId):</font>
<font color="black"> 215.         &quot;Handle a notation declaration event.&quot;</font>
<font color="black"> 216. </font>
<font color="green"> 217.     def unparsedEntityDecl(self, name, publicId, systemId, ndata):</font>
<font color="black"> 218.         &quot;Handle an unparsed entity declaration event.&quot;</font>
<font color="black"> 219. </font>
<font color="black"> 220. </font>
<font color="black"> 221. # ===== ENTITYRESOLVER =====</font>
<font color="black"> 222. </font>
<font color="green"> 223. class EntityResolver:</font>
<font color="black"> 224.     &quot;&quot;&quot;Basic interface for resolving entities. If you create an object</font>
<font color="black"> 225.     implementing this interface, then register the object with your</font>
<font color="black"> 226.     Parser, the parser will call the method in your object to</font>
<font color="black"> 227.     resolve all external entities. Note that DefaultHandler implements</font>
<font color="green"> 228.     this interface with the default behaviour.&quot;&quot;&quot;</font>
<font color="black"> 229. </font>
<font color="green"> 230.     def resolveEntity(self, publicId, systemId):</font>
<font color="black"> 231.         &quot;&quot;&quot;Resolve the system identifier of an entity and return either</font>
<font color="black"> 232.         the system identifier to read from as a string, or an InputSource</font>
<font color="black"> 233.         to read from.&quot;&quot;&quot;</font>
<font color="red"> 234.         return systemId</font>
<font color="black"> 235. </font>
<font color="black"> 236. </font>
<font color="black"> 237. #============================================================================</font>
<font color="black"> 238. #</font>
<font color="black"> 239. # CORE FEATURES</font>
<font color="black"> 240. #</font>
<font color="black"> 241. #============================================================================</font>
<font color="black"> 242. </font>
<font color="green"> 243. feature_namespaces = &quot;http://xml.org/sax/features/namespaces&quot;</font>
<font color="black"> 244. # true: Perform Namespace processing (default).</font>
<font color="black"> 245. # false: Optionally do not perform Namespace processing</font>
<font color="black"> 246. #        (implies namespace-prefixes).</font>
<font color="black"> 247. # access: (parsing) read-only; (not parsing) read/write</font>
<font color="black"> 248. </font>
<font color="green"> 249. feature_namespace_prefixes = &quot;http://xml.org/sax/features/namespace-prefixes&quot;</font>
<font color="black"> 250. # true: Report the original prefixed names and attributes used for Namespace</font>
<font color="black"> 251. #       declarations.</font>
<font color="black"> 252. # false: Do not report attributes used for Namespace declarations, and</font>
<font color="black"> 253. #        optionally do not report original prefixed names (default).</font>
<font color="black"> 254. # access: (parsing) read-only; (not parsing) read/write</font>
<font color="black"> 255. </font>
<font color="green"> 256. feature_string_interning = &quot;http://xml.org/sax/features/string-interning&quot;</font>
<font color="black"> 257. # true: All element names, prefixes, attribute names, Namespace URIs, and</font>
<font color="black"> 258. #       local names are interned using the built-in intern function.</font>
<font color="black"> 259. # false: Names are not necessarily interned, although they may be (default).</font>
<font color="black"> 260. # access: (parsing) read-only; (not parsing) read/write</font>
<font color="black"> 261. </font>
<font color="green"> 262. feature_validation = &quot;http://xml.org/sax/features/validation&quot;</font>
<font color="black"> 263. # true: Report all validation errors (implies external-general-entities and</font>
<font color="black"> 264. #       external-parameter-entities).</font>
<font color="black"> 265. # false: Do not report validation errors.</font>
<font color="black"> 266. # access: (parsing) read-only; (not parsing) read/write</font>
<font color="black"> 267. </font>
<font color="green"> 268. feature_external_ges = &quot;http://xml.org/sax/features/external-general-entities&quot;</font>
<font color="black"> 269. # true: Include all external general (text) entities.</font>
<font color="black"> 270. # false: Do not include external general entities.</font>
<font color="black"> 271. # access: (parsing) read-only; (not parsing) read/write</font>
<font color="black"> 272. </font>
<font color="green"> 273. feature_external_pes = &quot;http://xml.org/sax/features/external-parameter-entities&quot;</font>
<font color="black"> 274. # true: Include all external parameter entities, including the external</font>
<font color="black"> 275. #       DTD subset.</font>
<font color="black"> 276. # false: Do not include any external parameter entities, even the external</font>
<font color="black"> 277. #        DTD subset.</font>
<font color="black"> 278. # access: (parsing) read-only; (not parsing) read/write</font>
<font color="black"> 279. </font>
<font color="green"> 280. all_features = [feature_namespaces,</font>
<font color="green"> 281.                 feature_namespace_prefixes,</font>
<font color="green"> 282.                 feature_string_interning,</font>
<font color="green"> 283.                 feature_validation,</font>
<font color="green"> 284.                 feature_external_ges,</font>
<font color="green"> 285.                 feature_external_pes]</font>
<font color="black"> 286. </font>
<font color="black"> 287. </font>
<font color="black"> 288. #============================================================================</font>
<font color="black"> 289. #</font>
<font color="black"> 290. # CORE PROPERTIES</font>
<font color="black"> 291. #</font>
<font color="black"> 292. #============================================================================</font>
<font color="black"> 293. </font>
<font color="green"> 294. property_lexical_handler = &quot;http://xml.org/sax/properties/lexical-handler&quot;</font>
<font color="black"> 295. # data type: xml.sax.sax2lib.LexicalHandler</font>
<font color="black"> 296. # description: An optional extension handler for lexical events like comments.</font>
<font color="black"> 297. # access: read/write</font>
<font color="black"> 298. </font>
<font color="green"> 299. property_declaration_handler = &quot;http://xml.org/sax/properties/declaration-handler&quot;</font>
<font color="black"> 300. # data type: xml.sax.sax2lib.DeclHandler</font>
<font color="black"> 301. # description: An optional extension handler for DTD-related events other</font>
<font color="black"> 302. #              than notations and unparsed entities.</font>
<font color="black"> 303. # access: read/write</font>
<font color="black"> 304. </font>
<font color="green"> 305. property_dom_node = &quot;http://xml.org/sax/properties/dom-node&quot;</font>
<font color="black"> 306. # data type: org.w3c.dom.Node</font>
<font color="black"> 307. # description: When parsing, the current DOM node being visited if this is</font>
<font color="black"> 308. #              a DOM iterator; when not parsing, the root DOM node for</font>
<font color="black"> 309. #              iteration.</font>
<font color="black"> 310. # access: (parsing) read-only; (not parsing) read/write</font>
<font color="black"> 311. </font>
<font color="green"> 312. property_xml_string = &quot;http://xml.org/sax/properties/xml-string&quot;</font>
<font color="black"> 313. # data type: String</font>
<font color="black"> 314. # description: The literal string of characters that was the source for</font>
<font color="black"> 315. #              the current event.</font>
<font color="black"> 316. # access: read-only</font>
<font color="black"> 317. </font>
<font color="green"> 318. property_encoding = &quot;http://www.python.org/sax/properties/encoding&quot;</font>
<font color="black"> 319. # data type: String</font>
<font color="black"> 320. # description: The name of the encoding to assume for input data.</font>
<font color="black"> 321. # access: write: set the encoding, e.g. established by a higher-level</font>
<font color="black"> 322. #                protocol. May change during parsing (e.g. after</font>
<font color="black"> 323. #                processing a META tag)</font>
<font color="black"> 324. #         read:  return the current encoding (possibly established through</font>
<font color="black"> 325. #                auto-detection.</font>
<font color="black"> 326. # initial value: UTF-8</font>
<font color="black"> 327. #</font>
<font color="black"> 328. </font>
<font color="green"> 329. property_interning_dict = &quot;http://www.python.org/sax/properties/interning-dict&quot;</font>
<font color="black"> 330. # data type: Dictionary</font>
<font color="black"> 331. # description: The dictionary used to intern common strings in the document</font>
<font color="black"> 332. # access: write: Request that the parser uses a specific dictionary, to</font>
<font color="black"> 333. #                allow interning across different documents</font>
<font color="black"> 334. #         read:  return the current interning dictionary, or None</font>
<font color="black"> 335. #</font>
<font color="black"> 336. </font>
<font color="green"> 337. all_properties = [property_lexical_handler,</font>
<font color="green"> 338.                   property_dom_node,</font>
<font color="green"> 339.                   property_declaration_handler,</font>
<font color="green"> 340.                   property_xml_string,</font>
<font color="green"> 341.                   property_encoding,</font>
<font color="green"> 342.                   property_interning_dict]</font>
</pre>

