source file: <b>/root/buildbot/sandbox/lib/python2.7/site-packages/django/core/checks/model_checks.py</b><br>


file stats: <b>40 lines, 9 executed: 22.5% covered</b>
<pre>
<font color="black">   1. # -*- coding: utf-8 -*-</font>
<font color="green">   2. from __future__ import unicode_literals</font>
<font color="black">   3. </font>
<font color="green">   4. import inspect</font>
<font color="green">   5. import types</font>
<font color="black">   6. </font>
<font color="green">   7. from django.apps import apps</font>
<font color="green">   8. from django.core.checks import Error, Tags, register</font>
<font color="black">   9. </font>
<font color="black">  10. </font>
<font color="green">  11. @register(Tags.models)</font>
<font color="green">  12. def check_all_models(app_configs=None, **kwargs):</font>
<font color="red">  13.     errors = []</font>
<font color="red">  14.     for model in apps.get_models():</font>
<font color="red">  15.         if app_configs is None or model._meta.app_config in app_configs:</font>
<font color="red">  16.             if not inspect.ismethod(model.check):</font>
<font color="red">  17.                 errors.append(</font>
<font color="red">  18.                     Error(</font>
<font color="red">  19.                         &quot;The '%s.check()' class method is &quot;</font>
<font color="black">  20.                         &quot;currently overridden by %r.&quot; % (</font>
<font color="red">  21.                             model.__name__, model.check),</font>
<font color="red">  22.                         hint=None,</font>
<font color="red">  23.                         obj=model,</font>
<font color="red">  24.                         id='models.E020'</font>
<font color="black">  25.                     )</font>
<font color="black">  26.                 )</font>
<font color="black">  27.             else:</font>
<font color="red">  28.                 errors.extend(model.check(**kwargs))</font>
<font color="red">  29.     return errors</font>
<font color="black">  30. </font>
<font color="black">  31. </font>
<font color="green">  32. @register(Tags.models, Tags.signals)</font>
<font color="green">  33. def check_model_signals(app_configs=None, **kwargs):</font>
<font color="black">  34.     &quot;&quot;&quot;</font>
<font color="black">  35.     Ensure lazily referenced model signals senders are installed.</font>
<font color="black">  36.     &quot;&quot;&quot;</font>
<font color="black">  37.     # Avoid circular import</font>
<font color="red">  38.     from django.db import models</font>
<font color="black">  39. </font>
<font color="red">  40.     errors = []</font>
<font color="red">  41.     for name in dir(models.signals):</font>
<font color="red">  42.         obj = getattr(models.signals, name)</font>
<font color="red">  43.         if isinstance(obj, models.signals.ModelSignal):</font>
<font color="red">  44.             for reference, receivers in obj.unresolved_references.items():</font>
<font color="red">  45.                 for receiver, _, _ in receivers:</font>
<font color="black">  46.                     # The receiver is either a function or an instance of class</font>
<font color="black">  47.                     # defining a `__call__` method.</font>
<font color="red">  48.                     if isinstance(receiver, types.FunctionType):</font>
<font color="red">  49.                         description = &quot;The '%s' function&quot; % receiver.__name__</font>
<font color="black">  50.                     else:</font>
<font color="red">  51.                         description = &quot;An instance of the '%s' class&quot; % receiver.__class__.__name__</font>
<font color="red">  52.                     errors.append(</font>
<font color="red">  53.                         Error(</font>
<font color="red">  54.                             &quot;%s was connected to the '%s' signal &quot;</font>
<font color="black">  55.                             &quot;with a lazy reference to the '%s' sender, &quot;</font>
<font color="black">  56.                             &quot;which has not been installed.&quot; % (</font>
<font color="red">  57.                                 description, name, '.'.join(reference)</font>
<font color="black">  58.                             ),</font>
<font color="red">  59.                             obj=receiver.__module__,</font>
<font color="red">  60.                             hint=None,</font>
<font color="red">  61.                             id='signals.E001'</font>
<font color="black">  62.                         )</font>
<font color="black">  63.                     )</font>
<font color="red">  64.     return errors</font>
</pre>

