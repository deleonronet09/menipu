source file: <b>/root/buildbot/sandbox/lib/python2.7/site-packages/django/db/backends/sqlite3/features.py</b><br>


file stats: <b>51 lines, 38 executed: 74.5% covered</b>
<pre>
<font color="green">   1. from __future__ import unicode_literals</font>
<font color="black">   2. </font>
<font color="green">   3. from django.db import utils</font>
<font color="green">   4. from django.db.backends.base.features import BaseDatabaseFeatures</font>
<font color="green">   5. from django.utils import six</font>
<font color="green">   6. from django.utils.functional import cached_property</font>
<font color="black">   7. </font>
<font color="green">   8. from .base import Database</font>
<font color="black">   9. </font>
<font color="green">  10. try:</font>
<font color="green">  11.     import pytz</font>
<font color="green">  12. except ImportError:</font>
<font color="green">  13.     pytz = None</font>
<font color="black">  14. </font>
<font color="black">  15. </font>
<font color="green">  16. class DatabaseFeatures(BaseDatabaseFeatures):</font>
<font color="black">  17.     # SQLite cannot handle us only partially reading from a cursor's result set</font>
<font color="black">  18.     # and then writing the same rows to the database in another cursor. This</font>
<font color="black">  19.     # setting ensures we always read result sets fully into memory all in one</font>
<font color="black">  20.     # go.</font>
<font color="green">  21.     can_use_chunked_reads = False</font>
<font color="green">  22.     test_db_allows_multiple_connections = False</font>
<font color="green">  23.     supports_unspecified_pk = True</font>
<font color="green">  24.     supports_timezones = False</font>
<font color="green">  25.     supports_1000_query_parameters = False</font>
<font color="green">  26.     supports_mixed_date_datetime_comparisons = False</font>
<font color="green">  27.     has_bulk_insert = True</font>
<font color="green">  28.     can_combine_inserts_with_and_without_auto_increment_pk = False</font>
<font color="green">  29.     supports_foreign_keys = False</font>
<font color="green">  30.     supports_column_check_constraints = False</font>
<font color="green">  31.     autocommits_when_autocommit_is_off = True</font>
<font color="green">  32.     can_introspect_decimal_field = False</font>
<font color="green">  33.     can_introspect_positive_integer_field = True</font>
<font color="green">  34.     can_introspect_small_integer_field = True</font>
<font color="green">  35.     supports_transactions = True</font>
<font color="green">  36.     atomic_transactions = False</font>
<font color="green">  37.     can_rollback_ddl = True</font>
<font color="green">  38.     supports_paramstyle_pyformat = False</font>
<font color="green">  39.     supports_sequence_reset = False</font>
<font color="green">  40.     can_clone_databases = True</font>
<font color="black">  41. </font>
<font color="green">  42.     @cached_property</font>
<font color="black">  43.     def uses_savepoints(self):</font>
<font color="green">  44.         return Database.sqlite_version_info &gt;= (3, 6, 8)</font>
<font color="black">  45. </font>
<font color="green">  46.     @cached_property</font>
<font color="black">  47.     def can_release_savepoints(self):</font>
<font color="red">  48.         return self.uses_savepoints</font>
<font color="black">  49. </font>
<font color="green">  50.     @cached_property</font>
<font color="black">  51.     def can_share_in_memory_db(self):</font>
<font color="black">  52.         return (</font>
<font color="green">  53.             six.PY3 and</font>
<font color="red">  54.             Database.__name__ == 'sqlite3.dbapi2' and</font>
<font color="red">  55.             Database.sqlite_version_info &gt;= (3, 7, 13)</font>
<font color="black">  56.         )</font>
<font color="black">  57. </font>
<font color="green">  58.     @cached_property</font>
<font color="black">  59.     def supports_stddev(self):</font>
<font color="black">  60.         &quot;&quot;&quot;Confirm support for STDDEV and related stats functions</font>
<font color="black">  61. </font>
<font color="black">  62.         SQLite supports STDDEV as an extension package; so</font>
<font color="black">  63.         connection.ops.check_expression_support() can't unilaterally</font>
<font color="black">  64.         rule out support for STDDEV. We need to manually check</font>
<font color="black">  65.         whether the call works.</font>
<font color="black">  66.         &quot;&quot;&quot;</font>
<font color="red">  67.         with self.connection.cursor() as cursor:</font>
<font color="red">  68.             cursor.execute('CREATE TABLE STDDEV_TEST (X INT)')</font>
<font color="red">  69.             try:</font>
<font color="red">  70.                 cursor.execute('SELECT STDDEV(*) FROM STDDEV_TEST')</font>
<font color="red">  71.                 has_support = True</font>
<font color="red">  72.             except utils.DatabaseError:</font>
<font color="red">  73.                 has_support = False</font>
<font color="red">  74.             cursor.execute('DROP TABLE STDDEV_TEST')</font>
<font color="red">  75.         return has_support</font>
<font color="black">  76. </font>
<font color="green">  77.     @cached_property</font>
<font color="black">  78.     def has_zoneinfo_database(self):</font>
<font color="red">  79.         return pytz is not None</font>
</pre>

