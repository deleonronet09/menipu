source file: <b>/usr/lib/python2.7/sqlite3/dbapi2.py</b><br>


file stats: <b>41 lines, 26 executed: 63.4% covered</b>
<pre>
<font color="black">   1. # -*- coding: iso-8859-1 -*-</font>
<font color="black">   2. # pysqlite2/dbapi2.py: the DB-API 2.0 interface</font>
<font color="black">   3. #</font>
<font color="black">   4. # Copyright (C) 2004-2005 Gerhard Häring &lt;gh@ghaering.de&gt;</font>
<font color="black">   5. #</font>
<font color="black">   6. # This file is part of pysqlite.</font>
<font color="black">   7. #</font>
<font color="black">   8. # This software is provided 'as-is', without any express or implied</font>
<font color="black">   9. # warranty.  In no event will the authors be held liable for any damages</font>
<font color="black">  10. # arising from the use of this software.</font>
<font color="black">  11. #</font>
<font color="black">  12. # Permission is granted to anyone to use this software for any purpose,</font>
<font color="black">  13. # including commercial applications, and to alter it and redistribute it</font>
<font color="black">  14. # freely, subject to the following restrictions:</font>
<font color="black">  15. #</font>
<font color="black">  16. # 1. The origin of this software must not be misrepresented; you must not</font>
<font color="black">  17. #    claim that you wrote the original software. If you use this software</font>
<font color="black">  18. #    in a product, an acknowledgment in the product documentation would be</font>
<font color="black">  19. #    appreciated but is not required.</font>
<font color="black">  20. # 2. Altered source versions must be plainly marked as such, and must not be</font>
<font color="black">  21. #    misrepresented as being the original software.</font>
<font color="black">  22. # 3. This notice may not be removed or altered from any source distribution.</font>
<font color="black">  23. </font>
<font color="green">  24. import datetime</font>
<font color="green">  25. import time</font>
<font color="black">  26. </font>
<font color="green">  27. from _sqlite3 import *</font>
<font color="black">  28. </font>
<font color="green">  29. paramstyle = &quot;qmark&quot;</font>
<font color="black">  30. </font>
<font color="green">  31. threadsafety = 1</font>
<font color="black">  32. </font>
<font color="green">  33. apilevel = &quot;2.0&quot;</font>
<font color="black">  34. </font>
<font color="green">  35. Date = datetime.date</font>
<font color="black">  36. </font>
<font color="green">  37. Time = datetime.time</font>
<font color="black">  38. </font>
<font color="green">  39. Timestamp = datetime.datetime</font>
<font color="black">  40. </font>
<font color="green">  41. def DateFromTicks(ticks):</font>
<font color="red">  42.     return Date(*time.localtime(ticks)[:3])</font>
<font color="black">  43. </font>
<font color="green">  44. def TimeFromTicks(ticks):</font>
<font color="red">  45.     return Time(*time.localtime(ticks)[3:6])</font>
<font color="black">  46. </font>
<font color="green">  47. def TimestampFromTicks(ticks):</font>
<font color="red">  48.     return Timestamp(*time.localtime(ticks)[:6])</font>
<font color="black">  49. </font>
<font color="green">  50. version_info = tuple([int(x) for x in version.split(&quot;.&quot;)])</font>
<font color="green">  51. sqlite_version_info = tuple([int(x) for x in sqlite_version.split(&quot;.&quot;)])</font>
<font color="black">  52. </font>
<font color="green">  53. Binary = buffer</font>
<font color="black">  54. </font>
<font color="green">  55. def register_adapters_and_converters():</font>
<font color="green">  56.     def adapt_date(val):</font>
<font color="red">  57.         return val.isoformat()</font>
<font color="black">  58. </font>
<font color="green">  59.     def adapt_datetime(val):</font>
<font color="red">  60.         return val.isoformat(&quot; &quot;)</font>
<font color="black">  61. </font>
<font color="green">  62.     def convert_date(val):</font>
<font color="red">  63.         return datetime.date(*map(int, val.split(&quot;-&quot;)))</font>
<font color="black">  64. </font>
<font color="green">  65.     def convert_timestamp(val):</font>
<font color="red">  66.         datepart, timepart = val.split(&quot; &quot;)</font>
<font color="red">  67.         year, month, day = map(int, datepart.split(&quot;-&quot;))</font>
<font color="red">  68.         timepart_full = timepart.split(&quot;.&quot;)</font>
<font color="red">  69.         hours, minutes, seconds = map(int, timepart_full[0].split(&quot;:&quot;))</font>
<font color="red">  70.         if len(timepart_full) == 2:</font>
<font color="red">  71.             microseconds = int('{:0&lt;6.6}'.format(timepart_full[1].decode()))</font>
<font color="black">  72.         else:</font>
<font color="red">  73.             microseconds = 0</font>
<font color="black">  74. </font>
<font color="red">  75.         val = datetime.datetime(year, month, day, hours, minutes, seconds, microseconds)</font>
<font color="red">  76.         return val</font>
<font color="black">  77. </font>
<font color="black">  78. </font>
<font color="green">  79.     register_adapter(datetime.date, adapt_date)</font>
<font color="green">  80.     register_adapter(datetime.datetime, adapt_datetime)</font>
<font color="green">  81.     register_converter(&quot;date&quot;, convert_date)</font>
<font color="green">  82.     register_converter(&quot;timestamp&quot;, convert_timestamp)</font>
<font color="black">  83. </font>
<font color="green">  84. register_adapters_and_converters()</font>
<font color="black">  85. </font>
<font color="black">  86. # Clean up namespace</font>
<font color="black">  87. </font>
<font color="green">  88. del(register_adapters_and_converters)</font>
</pre>

