source file: <b>/root/buildbot/sandbox/lib/python2.7/site-packages/django/core/management/sql.py</b><br>


file stats: <b>34 lines, 26 executed: 76.5% covered</b>
<pre>
<font color="green">   1. from __future__ import unicode_literals</font>
<font color="black">   2. </font>
<font color="green">   3. from django.apps import apps</font>
<font color="green">   4. from django.db import models</font>
<font color="black">   5. </font>
<font color="black">   6. </font>
<font color="green">   7. def sql_flush(style, connection, only_django=False, reset_sequences=True, allow_cascade=False):</font>
<font color="black">   8.     &quot;&quot;&quot;</font>
<font color="black">   9.     Returns a list of the SQL statements used to flush the database.</font>
<font color="black">  10. </font>
<font color="black">  11.     If only_django is True, then only table names that have associated Django</font>
<font color="black">  12.     models and are in INSTALLED_APPS will be included.</font>
<font color="black">  13.     &quot;&quot;&quot;</font>
<font color="red">  14.     if only_django:</font>
<font color="red">  15.         tables = connection.introspection.django_table_names(only_existing=True, include_views=False)</font>
<font color="black">  16.     else:</font>
<font color="red">  17.         tables = connection.introspection.table_names(include_views=False)</font>
<font color="red">  18.     seqs = connection.introspection.sequence_list() if reset_sequences else ()</font>
<font color="red">  19.     statements = connection.ops.sql_flush(style, tables, seqs, allow_cascade)</font>
<font color="red">  20.     return statements</font>
<font color="black">  21. </font>
<font color="black">  22. </font>
<font color="green">  23. def emit_pre_migrate_signal(verbosity, interactive, db):</font>
<font color="black">  24.     # Emit the pre_migrate signal for every application.</font>
<font color="green">  25.     for app_config in apps.get_app_configs():</font>
<font color="green">  26.         if app_config.models_module is None:</font>
<font color="green">  27.             continue</font>
<font color="green">  28.         if verbosity &gt;= 2:</font>
<font color="red">  29.             print(&quot;Running pre-migrate handlers for application %s&quot; % app_config.label)</font>
<font color="green">  30.         models.signals.pre_migrate.send(</font>
<font color="green">  31.             sender=app_config,</font>
<font color="green">  32.             app_config=app_config,</font>
<font color="green">  33.             verbosity=verbosity,</font>
<font color="green">  34.             interactive=interactive,</font>
<font color="green">  35.             using=db)</font>
<font color="black">  36. </font>
<font color="black">  37. </font>
<font color="green">  38. def emit_post_migrate_signal(verbosity, interactive, db):</font>
<font color="black">  39.     # Emit the post_migrate signal for every application.</font>
<font color="green">  40.     for app_config in apps.get_app_configs():</font>
<font color="green">  41.         if app_config.models_module is None:</font>
<font color="green">  42.             continue</font>
<font color="green">  43.         if verbosity &gt;= 2:</font>
<font color="red">  44.             print(&quot;Running post-migrate handlers for application %s&quot; % app_config.label)</font>
<font color="green">  45.         models.signals.post_migrate.send(</font>
<font color="green">  46.             sender=app_config,</font>
<font color="green">  47.             app_config=app_config,</font>
<font color="green">  48.             verbosity=verbosity,</font>
<font color="green">  49.             interactive=interactive,</font>
<font color="green">  50.             using=db)</font>
</pre>

