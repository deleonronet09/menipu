source file: <b>/root/buildbot/sandbox/lib/python2.7/site-packages/django/contrib/auth/models.py</b><br>


file stats: <b>256 lines, 161 executed: 62.9% covered</b>
<pre>
<font color="green">   1. from __future__ import unicode_literals</font>
<font color="black">   2. </font>
<font color="green">   3. from django.contrib import auth</font>
<font color="green">   4. from django.contrib.auth.base_user import AbstractBaseUser, BaseUserManager</font>
<font color="green">   5. from django.contrib.auth.signals import user_logged_in</font>
<font color="green">   6. from django.contrib.contenttypes.models import ContentType</font>
<font color="green">   7. from django.core import validators</font>
<font color="green">   8. from django.core.exceptions import PermissionDenied</font>
<font color="green">   9. from django.core.mail import send_mail</font>
<font color="green">  10. from django.db import models</font>
<font color="green">  11. from django.db.models.manager import EmptyManager</font>
<font color="green">  12. from django.utils import six, timezone</font>
<font color="green">  13. from django.utils.encoding import python_2_unicode_compatible</font>
<font color="green">  14. from django.utils.translation import ugettext_lazy as _</font>
<font color="black">  15. </font>
<font color="black">  16. </font>
<font color="green">  17. def update_last_login(sender, user, **kwargs):</font>
<font color="black">  18.     &quot;&quot;&quot;</font>
<font color="black">  19.     A signal receiver which updates the last_login date for</font>
<font color="black">  20.     the user logging in.</font>
<font color="black">  21.     &quot;&quot;&quot;</font>
<font color="red">  22.     user.last_login = timezone.now()</font>
<font color="red">  23.     user.save(update_fields=['last_login'])</font>
<font color="green">  24. user_logged_in.connect(update_last_login)</font>
<font color="black">  25. </font>
<font color="black">  26. </font>
<font color="green">  27. class PermissionManager(models.Manager):</font>
<font color="green">  28.     use_in_migrations = True</font>
<font color="black">  29. </font>
<font color="green">  30.     def get_by_natural_key(self, codename, app_label, model):</font>
<font color="red">  31.         return self.get(</font>
<font color="red">  32.             codename=codename,</font>
<font color="red">  33.             content_type=ContentType.objects.db_manager(self.db).get_by_natural_key(app_label, model),</font>
<font color="black">  34.         )</font>
<font color="black">  35. </font>
<font color="black">  36. </font>
<font color="green">  37. @python_2_unicode_compatible</font>
<font color="green">  38. class Permission(models.Model):</font>
<font color="black">  39.     &quot;&quot;&quot;</font>
<font color="black">  40.     The permissions system provides a way to assign permissions to specific</font>
<font color="black">  41.     users and groups of users.</font>
<font color="black">  42. </font>
<font color="black">  43.     The permission system is used by the Django admin site, but may also be</font>
<font color="black">  44.     useful in your own code. The Django admin site uses permissions as follows:</font>
<font color="black">  45. </font>
<font color="black">  46.         - The &quot;add&quot; permission limits the user's ability to view the &quot;add&quot; form</font>
<font color="black">  47.           and add an object.</font>
<font color="black">  48.         - The &quot;change&quot; permission limits a user's ability to view the change</font>
<font color="black">  49.           list, view the &quot;change&quot; form and change an object.</font>
<font color="black">  50.         - The &quot;delete&quot; permission limits the ability to delete an object.</font>
<font color="black">  51. </font>
<font color="black">  52.     Permissions are set globally per type of object, not per specific object</font>
<font color="black">  53.     instance. It is possible to say &quot;Mary may change news stories,&quot; but it's</font>
<font color="black">  54.     not currently possible to say &quot;Mary may change news stories, but only the</font>
<font color="black">  55.     ones she created herself&quot; or &quot;Mary may only change news stories that have a</font>
<font color="black">  56.     certain status or publication date.&quot;</font>
<font color="black">  57. </font>
<font color="black">  58.     Three basic permissions -- add, change and delete -- are automatically</font>
<font color="black">  59.     created for each Django model.</font>
<font color="green">  60.     &quot;&quot;&quot;</font>
<font color="green">  61.     name = models.CharField(_('name'), max_length=255)</font>
<font color="green">  62.     content_type = models.ForeignKey(</font>
<font color="green">  63.         ContentType,</font>
<font color="green">  64.         models.CASCADE,</font>
<font color="green">  65.         verbose_name=_('content type'),</font>
<font color="black">  66.     )</font>
<font color="green">  67.     codename = models.CharField(_('codename'), max_length=100)</font>
<font color="green">  68.     objects = PermissionManager()</font>
<font color="black">  69. </font>
<font color="green">  70.     class Meta:</font>
<font color="green">  71.         verbose_name = _('permission')</font>
<font color="green">  72.         verbose_name_plural = _('permissions')</font>
<font color="green">  73.         unique_together = (('content_type', 'codename'),)</font>
<font color="black">  74.         ordering = ('content_type__app_label', 'content_type__model',</font>
<font color="green">  75.                     'codename')</font>
<font color="black">  76. </font>
<font color="green">  77.     def __str__(self):</font>
<font color="red">  78.         return &quot;%s | %s | %s&quot; % (</font>
<font color="red">  79.             six.text_type(self.content_type.app_label),</font>
<font color="red">  80.             six.text_type(self.content_type),</font>
<font color="red">  81.             six.text_type(self.name))</font>
<font color="black">  82. </font>
<font color="green">  83.     def natural_key(self):</font>
<font color="red">  84.         return (self.codename,) + self.content_type.natural_key()</font>
<font color="green">  85.     natural_key.dependencies = ['contenttypes.contenttype']</font>
<font color="black">  86. </font>
<font color="black">  87. </font>
<font color="green">  88. class GroupManager(models.Manager):</font>
<font color="black">  89.     &quot;&quot;&quot;</font>
<font color="black">  90.     The manager for the auth's Group model.</font>
<font color="green">  91.     &quot;&quot;&quot;</font>
<font color="green">  92.     use_in_migrations = True</font>
<font color="black">  93. </font>
<font color="green">  94.     def get_by_natural_key(self, name):</font>
<font color="red">  95.         return self.get(name=name)</font>
<font color="black">  96. </font>
<font color="black">  97. </font>
<font color="green">  98. @python_2_unicode_compatible</font>
<font color="green">  99. class Group(models.Model):</font>
<font color="black"> 100.     &quot;&quot;&quot;</font>
<font color="black"> 101.     Groups are a generic way of categorizing users to apply permissions, or</font>
<font color="black"> 102.     some other label, to those users. A user can belong to any number of</font>
<font color="black"> 103.     groups.</font>
<font color="black"> 104. </font>
<font color="black"> 105.     A user in a group automatically has all the permissions granted to that</font>
<font color="black"> 106.     group. For example, if the group Site editors has the permission</font>
<font color="black"> 107.     can_edit_home_page, any user in that group will have that permission.</font>
<font color="black"> 108. </font>
<font color="black"> 109.     Beyond permissions, groups are a convenient way to categorize users to</font>
<font color="black"> 110.     apply some label, or extended functionality, to them. For example, you</font>
<font color="black"> 111.     could create a group 'Special users', and you could write code that would</font>
<font color="black"> 112.     do special things to those users -- such as giving them access to a</font>
<font color="black"> 113.     members-only portion of your site, or sending them members-only email</font>
<font color="black"> 114.     messages.</font>
<font color="green"> 115.     &quot;&quot;&quot;</font>
<font color="green"> 116.     name = models.CharField(_('name'), max_length=80, unique=True)</font>
<font color="green"> 117.     permissions = models.ManyToManyField(</font>
<font color="green"> 118.         Permission,</font>
<font color="green"> 119.         verbose_name=_('permissions'),</font>
<font color="green"> 120.         blank=True,</font>
<font color="black"> 121.     )</font>
<font color="black"> 122. </font>
<font color="green"> 123.     objects = GroupManager()</font>
<font color="black"> 124. </font>
<font color="green"> 125.     class Meta:</font>
<font color="green"> 126.         verbose_name = _('group')</font>
<font color="green"> 127.         verbose_name_plural = _('groups')</font>
<font color="black"> 128. </font>
<font color="green"> 129.     def __str__(self):</font>
<font color="red"> 130.         return self.name</font>
<font color="black"> 131. </font>
<font color="green"> 132.     def natural_key(self):</font>
<font color="red"> 133.         return (self.name,)</font>
<font color="black"> 134. </font>
<font color="black"> 135. </font>
<font color="green"> 136. class UserManager(BaseUserManager):</font>
<font color="green"> 137.     use_in_migrations = True</font>
<font color="black"> 138. </font>
<font color="green"> 139.     def _create_user(self, username, email, password, **extra_fields):</font>
<font color="black"> 140.         &quot;&quot;&quot;</font>
<font color="black"> 141.         Creates and saves a User with the given username, email and password.</font>
<font color="black"> 142.         &quot;&quot;&quot;</font>
<font color="red"> 143.         if not username:</font>
<font color="red"> 144.             raise ValueError('The given username must be set')</font>
<font color="red"> 145.         email = self.normalize_email(email)</font>
<font color="red"> 146.         user = self.model(username=username, email=email, **extra_fields)</font>
<font color="red"> 147.         user.set_password(password)</font>
<font color="red"> 148.         user.save(using=self._db)</font>
<font color="red"> 149.         return user</font>
<font color="black"> 150. </font>
<font color="green"> 151.     def create_user(self, username, email=None, password=None, **extra_fields):</font>
<font color="red"> 152.         extra_fields.setdefault('is_staff', False)</font>
<font color="red"> 153.         extra_fields.setdefault('is_superuser', False)</font>
<font color="red"> 154.         return self._create_user(username, email, password, **extra_fields)</font>
<font color="black"> 155. </font>
<font color="green"> 156.     def create_superuser(self, username, email, password, **extra_fields):</font>
<font color="red"> 157.         extra_fields.setdefault('is_staff', True)</font>
<font color="red"> 158.         extra_fields.setdefault('is_superuser', True)</font>
<font color="black"> 159. </font>
<font color="red"> 160.         if extra_fields.get('is_staff') is not True:</font>
<font color="red"> 161.             raise ValueError('Superuser must have is_staff=True.')</font>
<font color="red"> 162.         if extra_fields.get('is_superuser') is not True:</font>
<font color="red"> 163.             raise ValueError('Superuser must have is_superuser=True.')</font>
<font color="black"> 164. </font>
<font color="red"> 165.         return self._create_user(username, email, password, **extra_fields)</font>
<font color="black"> 166. </font>
<font color="black"> 167. </font>
<font color="black"> 168. # A few helper functions for common logic between User and AnonymousUser.</font>
<font color="green"> 169. def _user_get_all_permissions(user, obj):</font>
<font color="red"> 170.     permissions = set()</font>
<font color="red"> 171.     for backend in auth.get_backends():</font>
<font color="red"> 172.         if hasattr(backend, &quot;get_all_permissions&quot;):</font>
<font color="red"> 173.             permissions.update(backend.get_all_permissions(user, obj))</font>
<font color="red"> 174.     return permissions</font>
<font color="black"> 175. </font>
<font color="black"> 176. </font>
<font color="green"> 177. def _user_has_perm(user, perm, obj):</font>
<font color="black"> 178.     &quot;&quot;&quot;</font>
<font color="black"> 179.     A backend can raise `PermissionDenied` to short-circuit permission checking.</font>
<font color="black"> 180.     &quot;&quot;&quot;</font>
<font color="red"> 181.     for backend in auth.get_backends():</font>
<font color="red"> 182.         if not hasattr(backend, 'has_perm'):</font>
<font color="red"> 183.             continue</font>
<font color="red"> 184.         try:</font>
<font color="red"> 185.             if backend.has_perm(user, perm, obj):</font>
<font color="red"> 186.                 return True</font>
<font color="red"> 187.         except PermissionDenied:</font>
<font color="red"> 188.             return False</font>
<font color="red"> 189.     return False</font>
<font color="black"> 190. </font>
<font color="black"> 191. </font>
<font color="green"> 192. def _user_has_module_perms(user, app_label):</font>
<font color="black"> 193.     &quot;&quot;&quot;</font>
<font color="black"> 194.     A backend can raise `PermissionDenied` to short-circuit permission checking.</font>
<font color="black"> 195.     &quot;&quot;&quot;</font>
<font color="red"> 196.     for backend in auth.get_backends():</font>
<font color="red"> 197.         if not hasattr(backend, 'has_module_perms'):</font>
<font color="red"> 198.             continue</font>
<font color="red"> 199.         try:</font>
<font color="red"> 200.             if backend.has_module_perms(user, app_label):</font>
<font color="red"> 201.                 return True</font>
<font color="red"> 202.         except PermissionDenied:</font>
<font color="red"> 203.             return False</font>
<font color="red"> 204.     return False</font>
<font color="black"> 205. </font>
<font color="black"> 206. </font>
<font color="green"> 207. class PermissionsMixin(models.Model):</font>
<font color="black"> 208.     &quot;&quot;&quot;</font>
<font color="black"> 209.     A mixin class that adds the fields and methods necessary to support</font>
<font color="black"> 210.     Django's Group and Permission model using the ModelBackend.</font>
<font color="green"> 211.     &quot;&quot;&quot;</font>
<font color="green"> 212.     is_superuser = models.BooleanField(</font>
<font color="green"> 213.         _('superuser status'),</font>
<font color="green"> 214.         default=False,</font>
<font color="green"> 215.         help_text=_(</font>
<font color="green"> 216.             'Designates that this user has all permissions without '</font>
<font color="black"> 217.             'explicitly assigning them.'</font>
<font color="black"> 218.         ),</font>
<font color="black"> 219.     )</font>
<font color="green"> 220.     groups = models.ManyToManyField(</font>
<font color="green"> 221.         Group,</font>
<font color="green"> 222.         verbose_name=_('groups'),</font>
<font color="green"> 223.         blank=True,</font>
<font color="green"> 224.         help_text=_(</font>
<font color="green"> 225.             'The groups this user belongs to. A user will get all permissions '</font>
<font color="black"> 226.             'granted to each of their groups.'</font>
<font color="black"> 227.         ),</font>
<font color="green"> 228.         related_name=&quot;user_set&quot;,</font>
<font color="green"> 229.         related_query_name=&quot;user&quot;,</font>
<font color="black"> 230.     )</font>
<font color="green"> 231.     user_permissions = models.ManyToManyField(</font>
<font color="green"> 232.         Permission,</font>
<font color="green"> 233.         verbose_name=_('user permissions'),</font>
<font color="green"> 234.         blank=True,</font>
<font color="green"> 235.         help_text=_('Specific permissions for this user.'),</font>
<font color="green"> 236.         related_name=&quot;user_set&quot;,</font>
<font color="green"> 237.         related_query_name=&quot;user&quot;,</font>
<font color="black"> 238.     )</font>
<font color="black"> 239. </font>
<font color="green"> 240.     class Meta:</font>
<font color="green"> 241.         abstract = True</font>
<font color="black"> 242. </font>
<font color="green"> 243.     def get_group_permissions(self, obj=None):</font>
<font color="black"> 244.         &quot;&quot;&quot;</font>
<font color="black"> 245.         Returns a list of permission strings that this user has through their</font>
<font color="black"> 246.         groups. This method queries all available auth backends. If an object</font>
<font color="black"> 247.         is passed in, only permissions matching this object are returned.</font>
<font color="black"> 248.         &quot;&quot;&quot;</font>
<font color="red"> 249.         permissions = set()</font>
<font color="red"> 250.         for backend in auth.get_backends():</font>
<font color="red"> 251.             if hasattr(backend, &quot;get_group_permissions&quot;):</font>
<font color="red"> 252.                 permissions.update(backend.get_group_permissions(self, obj))</font>
<font color="red"> 253.         return permissions</font>
<font color="black"> 254. </font>
<font color="green"> 255.     def get_all_permissions(self, obj=None):</font>
<font color="red"> 256.         return _user_get_all_permissions(self, obj)</font>
<font color="black"> 257. </font>
<font color="green"> 258.     def has_perm(self, perm, obj=None):</font>
<font color="black"> 259.         &quot;&quot;&quot;</font>
<font color="black"> 260.         Returns True if the user has the specified permission. This method</font>
<font color="black"> 261.         queries all available auth backends, but returns immediately if any</font>
<font color="black"> 262.         backend returns True. Thus, a user who has permission from a single</font>
<font color="black"> 263.         auth backend is assumed to have permission in general. If an object is</font>
<font color="black"> 264.         provided, permissions for this specific object are checked.</font>
<font color="black"> 265.         &quot;&quot;&quot;</font>
<font color="black"> 266. </font>
<font color="black"> 267.         # Active superusers have all permissions.</font>
<font color="red"> 268.         if self.is_active and self.is_superuser:</font>
<font color="red"> 269.             return True</font>
<font color="black"> 270. </font>
<font color="black"> 271.         # Otherwise we need to check the backends.</font>
<font color="red"> 272.         return _user_has_perm(self, perm, obj)</font>
<font color="black"> 273. </font>
<font color="green"> 274.     def has_perms(self, perm_list, obj=None):</font>
<font color="black"> 275.         &quot;&quot;&quot;</font>
<font color="black"> 276.         Returns True if the user has each of the specified permissions. If</font>
<font color="black"> 277.         object is passed, it checks if the user has all required perms for this</font>
<font color="black"> 278.         object.</font>
<font color="black"> 279.         &quot;&quot;&quot;</font>
<font color="red"> 280.         for perm in perm_list:</font>
<font color="red"> 281.             if not self.has_perm(perm, obj):</font>
<font color="red"> 282.                 return False</font>
<font color="red"> 283.         return True</font>
<font color="black"> 284. </font>
<font color="green"> 285.     def has_module_perms(self, app_label):</font>
<font color="black"> 286.         &quot;&quot;&quot;</font>
<font color="black"> 287.         Returns True if the user has any permissions in the given app label.</font>
<font color="black"> 288.         Uses pretty much the same logic as has_perm, above.</font>
<font color="black"> 289.         &quot;&quot;&quot;</font>
<font color="black"> 290.         # Active superusers have all permissions.</font>
<font color="red"> 291.         if self.is_active and self.is_superuser:</font>
<font color="red"> 292.             return True</font>
<font color="black"> 293. </font>
<font color="red"> 294.         return _user_has_module_perms(self, app_label)</font>
<font color="black"> 295. </font>
<font color="black"> 296. </font>
<font color="green"> 297. class AbstractUser(AbstractBaseUser, PermissionsMixin):</font>
<font color="black"> 298.     &quot;&quot;&quot;</font>
<font color="black"> 299.     An abstract base class implementing a fully featured User model with</font>
<font color="black"> 300.     admin-compliant permissions.</font>
<font color="black"> 301. </font>
<font color="black"> 302.     Username and password are required. Other fields are optional.</font>
<font color="green"> 303.     &quot;&quot;&quot;</font>
<font color="green"> 304.     username = models.CharField(</font>
<font color="green"> 305.         _('username'),</font>
<font color="green"> 306.         max_length=30,</font>
<font color="green"> 307.         unique=True,</font>
<font color="green"> 308.         help_text=_('Required. 30 characters or fewer. Letters, digits and @/./+/-/_ only.'),</font>
<font color="black"> 309.         validators=[</font>
<font color="green"> 310.             validators.RegexValidator(</font>
<font color="green"> 311.                 r'^[\w.@+-]+$',</font>
<font color="green"> 312.                 _('Enter a valid username. This value may contain only '</font>
<font color="black"> 313.                   'letters, numbers ' 'and @/./+/-/_ characters.')</font>
<font color="black"> 314.             ),</font>
<font color="black"> 315.         ],</font>
<font color="green"> 316.         error_messages={</font>
<font color="green"> 317.             'unique': _(&quot;A user with that username already exists.&quot;),</font>
<font color="black"> 318.         },</font>
<font color="black"> 319.     )</font>
<font color="green"> 320.     first_name = models.CharField(_('first name'), max_length=30, blank=True)</font>
<font color="green"> 321.     last_name = models.CharField(_('last name'), max_length=30, blank=True)</font>
<font color="green"> 322.     email = models.EmailField(_('email address'), blank=True)</font>
<font color="green"> 323.     is_staff = models.BooleanField(</font>
<font color="green"> 324.         _('staff status'),</font>
<font color="green"> 325.         default=False,</font>
<font color="green"> 326.         help_text=_('Designates whether the user can log into this admin site.'),</font>
<font color="black"> 327.     )</font>
<font color="green"> 328.     is_active = models.BooleanField(</font>
<font color="green"> 329.         _('active'),</font>
<font color="green"> 330.         default=True,</font>
<font color="green"> 331.         help_text=_(</font>
<font color="green"> 332.             'Designates whether this user should be treated as active. '</font>
<font color="black"> 333.             'Unselect this instead of deleting accounts.'</font>
<font color="black"> 334.         ),</font>
<font color="black"> 335.     )</font>
<font color="green"> 336.     date_joined = models.DateTimeField(_('date joined'), default=timezone.now)</font>
<font color="black"> 337. </font>
<font color="green"> 338.     objects = UserManager()</font>
<font color="black"> 339. </font>
<font color="green"> 340.     USERNAME_FIELD = 'username'</font>
<font color="green"> 341.     REQUIRED_FIELDS = ['email']</font>
<font color="black"> 342. </font>
<font color="green"> 343.     class Meta:</font>
<font color="green"> 344.         verbose_name = _('user')</font>
<font color="green"> 345.         verbose_name_plural = _('users')</font>
<font color="green"> 346.         abstract = True</font>
<font color="black"> 347. </font>
<font color="green"> 348.     def get_full_name(self):</font>
<font color="black"> 349.         &quot;&quot;&quot;</font>
<font color="black"> 350.         Returns the first_name plus the last_name, with a space in between.</font>
<font color="black"> 351.         &quot;&quot;&quot;</font>
<font color="red"> 352.         full_name = '%s %s' % (self.first_name, self.last_name)</font>
<font color="red"> 353.         return full_name.strip()</font>
<font color="black"> 354. </font>
<font color="green"> 355.     def get_short_name(self):</font>
<font color="black"> 356.         &quot;Returns the short name for the user.&quot;</font>
<font color="red"> 357.         return self.first_name</font>
<font color="black"> 358. </font>
<font color="green"> 359.     def email_user(self, subject, message, from_email=None, **kwargs):</font>
<font color="black"> 360.         &quot;&quot;&quot;</font>
<font color="black"> 361.         Sends an email to this User.</font>
<font color="black"> 362.         &quot;&quot;&quot;</font>
<font color="red"> 363.         send_mail(subject, message, from_email, [self.email], **kwargs)</font>
<font color="black"> 364. </font>
<font color="black"> 365. </font>
<font color="green"> 366. class User(AbstractUser):</font>
<font color="black"> 367.     &quot;&quot;&quot;</font>
<font color="black"> 368.     Users within the Django authentication system are represented by this</font>
<font color="black"> 369.     model.</font>
<font color="black"> 370. </font>
<font color="black"> 371.     Username, password and email are required. Other fields are optional.</font>
<font color="green"> 372.     &quot;&quot;&quot;</font>
<font color="green"> 373.     class Meta(AbstractUser.Meta):</font>
<font color="green"> 374.         swappable = 'AUTH_USER_MODEL'</font>
<font color="black"> 375. </font>
<font color="black"> 376. </font>
<font color="green"> 377. @python_2_unicode_compatible</font>
<font color="green"> 378. class AnonymousUser(object):</font>
<font color="green"> 379.     id = None</font>
<font color="green"> 380.     pk = None</font>
<font color="green"> 381.     username = ''</font>
<font color="green"> 382.     is_staff = False</font>
<font color="green"> 383.     is_active = False</font>
<font color="green"> 384.     is_superuser = False</font>
<font color="green"> 385.     _groups = EmptyManager(Group)</font>
<font color="green"> 386.     _user_permissions = EmptyManager(Permission)</font>
<font color="black"> 387. </font>
<font color="green"> 388.     def __init__(self):</font>
<font color="red"> 389.         pass</font>
<font color="black"> 390. </font>
<font color="green"> 391.     def __str__(self):</font>
<font color="red"> 392.         return 'AnonymousUser'</font>
<font color="black"> 393. </font>
<font color="green"> 394.     def __eq__(self, other):</font>
<font color="red"> 395.         return isinstance(other, self.__class__)</font>
<font color="black"> 396. </font>
<font color="green"> 397.     def __ne__(self, other):</font>
<font color="red"> 398.         return not self.__eq__(other)</font>
<font color="black"> 399. </font>
<font color="green"> 400.     def __hash__(self):</font>
<font color="red"> 401.         return 1  # instances always return the same hash value</font>
<font color="black"> 402. </font>
<font color="green"> 403.     def save(self):</font>
<font color="red"> 404.         raise NotImplementedError(&quot;Django doesn't provide a DB representation for AnonymousUser.&quot;)</font>
<font color="black"> 405. </font>
<font color="green"> 406.     def delete(self):</font>
<font color="red"> 407.         raise NotImplementedError(&quot;Django doesn't provide a DB representation for AnonymousUser.&quot;)</font>
<font color="black"> 408. </font>
<font color="green"> 409.     def set_password(self, raw_password):</font>
<font color="red"> 410.         raise NotImplementedError(&quot;Django doesn't provide a DB representation for AnonymousUser.&quot;)</font>
<font color="black"> 411. </font>
<font color="green"> 412.     def check_password(self, raw_password):</font>
<font color="red"> 413.         raise NotImplementedError(&quot;Django doesn't provide a DB representation for AnonymousUser.&quot;)</font>
<font color="black"> 414. </font>
<font color="green"> 415.     def _get_groups(self):</font>
<font color="red"> 416.         return self._groups</font>
<font color="green"> 417.     groups = property(_get_groups)</font>
<font color="black"> 418. </font>
<font color="green"> 419.     def _get_user_permissions(self):</font>
<font color="red"> 420.         return self._user_permissions</font>
<font color="green"> 421.     user_permissions = property(_get_user_permissions)</font>
<font color="black"> 422. </font>
<font color="green"> 423.     def get_group_permissions(self, obj=None):</font>
<font color="red"> 424.         return set()</font>
<font color="black"> 425. </font>
<font color="green"> 426.     def get_all_permissions(self, obj=None):</font>
<font color="red"> 427.         return _user_get_all_permissions(self, obj=obj)</font>
<font color="black"> 428. </font>
<font color="green"> 429.     def has_perm(self, perm, obj=None):</font>
<font color="red"> 430.         return _user_has_perm(self, perm, obj=obj)</font>
<font color="black"> 431. </font>
<font color="green"> 432.     def has_perms(self, perm_list, obj=None):</font>
<font color="red"> 433.         for perm in perm_list:</font>
<font color="red"> 434.             if not self.has_perm(perm, obj):</font>
<font color="red"> 435.                 return False</font>
<font color="red"> 436.         return True</font>
<font color="black"> 437. </font>
<font color="green"> 438.     def has_module_perms(self, module):</font>
<font color="red"> 439.         return _user_has_module_perms(self, module)</font>
<font color="black"> 440. </font>
<font color="green"> 441.     def is_anonymous(self):</font>
<font color="red"> 442.         return True</font>
<font color="black"> 443. </font>
<font color="green"> 444.     def is_authenticated(self):</font>
<font color="red"> 445.         return False</font>
<font color="black"> 446. </font>
<font color="green"> 447.     def get_username(self):</font>
<font color="red"> 448.         return self.username</font>
</pre>

