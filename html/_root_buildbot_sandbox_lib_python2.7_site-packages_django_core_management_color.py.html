source file: <b>/root/buildbot/sandbox/lib/python2.7/site-packages/django/core/management/color.py</b><br>


file stats: <b>30 lines, 26 executed: 86.7% covered</b>
<pre>
<font color="black">   1. &quot;&quot;&quot;</font>
<font color="black">   2. Sets up the terminal color scheme.</font>
<font color="green">   3. &quot;&quot;&quot;</font>
<font color="black">   4. </font>
<font color="green">   5. import os</font>
<font color="green">   6. import sys</font>
<font color="black">   7. </font>
<font color="green">   8. from django.utils import lru_cache, termcolors</font>
<font color="black">   9. </font>
<font color="black">  10. </font>
<font color="green">  11. def supports_color():</font>
<font color="black">  12.     &quot;&quot;&quot;</font>
<font color="black">  13.     Returns True if the running system's terminal supports color,</font>
<font color="black">  14.     and False otherwise.</font>
<font color="black">  15.     &quot;&quot;&quot;</font>
<font color="green">  16.     plat = sys.platform</font>
<font color="green">  17.     supported_platform = plat != 'Pocket PC' and (plat != 'win32' or 'ANSICON' in os.environ)</font>
<font color="black">  18. </font>
<font color="black">  19.     # isatty is not always implemented, #6223.</font>
<font color="green">  20.     is_a_tty = hasattr(sys.stdout, 'isatty') and sys.stdout.isatty()</font>
<font color="green">  21.     if not supported_platform or not is_a_tty:</font>
<font color="red">  22.         return False</font>
<font color="green">  23.     return True</font>
<font color="black">  24. </font>
<font color="black">  25. </font>
<font color="green">  26. class Style(object):</font>
<font color="green">  27.     pass</font>
<font color="black">  28. </font>
<font color="black">  29. </font>
<font color="green">  30. def make_style(config_string=''):</font>
<font color="black">  31.     &quot;&quot;&quot;</font>
<font color="black">  32.     Create a Style object from the given config_string.</font>
<font color="black">  33. </font>
<font color="black">  34.     If config_string is empty django.utils.termcolors.DEFAULT_PALETTE is used.</font>
<font color="black">  35.     &quot;&quot;&quot;</font>
<font color="black">  36. </font>
<font color="green">  37.     style = Style()</font>
<font color="black">  38. </font>
<font color="green">  39.     color_settings = termcolors.parse_color_setting(config_string)</font>
<font color="black">  40. </font>
<font color="black">  41.     # The nocolor palette has all available roles.</font>
<font color="black">  42.     # Use that palette as the basis for populating</font>
<font color="black">  43.     # the palette as defined in the environment.</font>
<font color="green">  44.     for role in termcolors.PALETTES[termcolors.NOCOLOR_PALETTE]:</font>
<font color="green">  45.         if color_settings:</font>
<font color="green">  46.             format = color_settings.get(role, {})</font>
<font color="green">  47.             style_func = termcolors.make_style(**format)</font>
<font color="black">  48.         else:</font>
<font color="red">  49.             style_func = lambda x: x</font>
<font color="green">  50.         setattr(style, role, style_func)</font>
<font color="black">  51. </font>
<font color="black">  52.     # For backwards compatibility,</font>
<font color="black">  53.     # set style for ERROR_OUTPUT == ERROR</font>
<font color="green">  54.     style.ERROR_OUTPUT = style.ERROR</font>
<font color="black">  55. </font>
<font color="green">  56.     return style</font>
<font color="black">  57. </font>
<font color="black">  58. </font>
<font color="green">  59. @lru_cache.lru_cache(maxsize=None)</font>
<font color="black">  60. def no_style():</font>
<font color="black">  61.     &quot;&quot;&quot;</font>
<font color="black">  62.     Returns a Style object with no color scheme.</font>
<font color="black">  63.     &quot;&quot;&quot;</font>
<font color="red">  64.     return make_style('nocolor')</font>
<font color="black">  65. </font>
<font color="black">  66. </font>
<font color="green">  67. def color_style():</font>
<font color="black">  68.     &quot;&quot;&quot;</font>
<font color="black">  69.     Returns a Style object from the Django color scheme.</font>
<font color="black">  70.     &quot;&quot;&quot;</font>
<font color="green">  71.     if not supports_color():</font>
<font color="red">  72.         return no_style()</font>
<font color="green">  73.     return make_style(os.environ.get('DJANGO_COLORS', ''))</font>
</pre>

