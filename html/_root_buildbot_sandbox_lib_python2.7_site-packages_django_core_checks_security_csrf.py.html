source file: <b>/root/buildbot/sandbox/lib/python2.7/site-packages/django/core/checks/security/csrf.py</b><br>


file stats: <b>24 lines, 15 executed: 62.5% covered</b>
<pre>
<font color="green">   1. from django.conf import settings</font>
<font color="black">   2. </font>
<font color="green">   3. from .. import Tags, Warning, register</font>
<font color="black">   4. </font>
<font color="green">   5. W003 = Warning(</font>
<font color="green">   6.     &quot;You don't appear to be using Django's built-in &quot;</font>
<font color="black">   7.     &quot;cross-site request forgery protection via the middleware &quot;</font>
<font color="black">   8.     &quot;('django.middleware.csrf.CsrfViewMiddleware' is not in your &quot;</font>
<font color="black">   9.     &quot;MIDDLEWARE_CLASSES). Enabling the middleware is the safest approach &quot;</font>
<font color="black">  10.     &quot;to ensure you don't leave any holes.&quot;,</font>
<font color="green">  11.     id='security.W003',</font>
<font color="black">  12. )</font>
<font color="black">  13. </font>
<font color="green">  14. W016 = Warning(</font>
<font color="green">  15.     &quot;You have 'django.middleware.csrf.CsrfViewMiddleware' in your &quot;</font>
<font color="black">  16.     &quot;MIDDLEWARE_CLASSES, but you have not set CSRF_COOKIE_SECURE to True. &quot;</font>
<font color="black">  17.     &quot;Using a secure-only CSRF cookie makes it more difficult for network &quot;</font>
<font color="black">  18.     &quot;traffic sniffers to steal the CSRF token.&quot;,</font>
<font color="green">  19.     id='security.W016',</font>
<font color="black">  20. )</font>
<font color="black">  21. </font>
<font color="green">  22. W017 = Warning(</font>
<font color="green">  23.     &quot;You have 'django.middleware.csrf.CsrfViewMiddleware' in your &quot;</font>
<font color="black">  24.     &quot;MIDDLEWARE_CLASSES, but you have not set CSRF_COOKIE_HTTPONLY to True. &quot;</font>
<font color="black">  25.     &quot;Using an HttpOnly CSRF cookie makes it more difficult for cross-site &quot;</font>
<font color="black">  26.     &quot;scripting attacks to steal the CSRF token.&quot;,</font>
<font color="green">  27.     id='security.W017',</font>
<font color="black">  28. )</font>
<font color="black">  29. </font>
<font color="black">  30. </font>
<font color="green">  31. def _csrf_middleware():</font>
<font color="red">  32.     return &quot;django.middleware.csrf.CsrfViewMiddleware&quot; in settings.MIDDLEWARE_CLASSES</font>
<font color="black">  33. </font>
<font color="black">  34. </font>
<font color="green">  35. @register(Tags.security, deploy=True)</font>
<font color="black">  36. def check_csrf_middleware(app_configs, **kwargs):</font>
<font color="red">  37.     passed_check = _csrf_middleware()</font>
<font color="red">  38.     return [] if passed_check else [W003]</font>
<font color="black">  39. </font>
<font color="black">  40. </font>
<font color="green">  41. @register(Tags.security, deploy=True)</font>
<font color="black">  42. def check_csrf_cookie_secure(app_configs, **kwargs):</font>
<font color="black">  43.     passed_check = (</font>
<font color="red">  44.         not _csrf_middleware() or</font>
<font color="red">  45.         settings.CSRF_COOKIE_SECURE</font>
<font color="black">  46.     )</font>
<font color="red">  47.     return [] if passed_check else [W016]</font>
<font color="black">  48. </font>
<font color="black">  49. </font>
<font color="green">  50. @register(Tags.security, deploy=True)</font>
<font color="black">  51. def check_csrf_cookie_httponly(app_configs, **kwargs):</font>
<font color="black">  52.     passed_check = (</font>
<font color="red">  53.         not _csrf_middleware() or</font>
<font color="red">  54.         settings.CSRF_COOKIE_HTTPONLY</font>
<font color="black">  55.     )</font>
<font color="red">  56.     return [] if passed_check else [W017]</font>
</pre>

