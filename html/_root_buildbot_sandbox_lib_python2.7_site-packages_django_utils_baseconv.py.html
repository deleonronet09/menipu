source file: <b>/root/buildbot/sandbox/lib/python2.7/site-packages/django/utils/baseconv.py</b><br>


file stats: <b>48 lines, 23 executed: 47.9% covered</b>
<pre>
<font color="black">   1. # Copyright (c) 2010 Guilherme Gondim. All rights reserved.</font>
<font color="black">   2. # Copyright (c) 2009 Simon Willison. All rights reserved.</font>
<font color="black">   3. # Copyright (c) 2002 Drew Perttula. All rights reserved.</font>
<font color="black">   4. #</font>
<font color="black">   5. # License:</font>
<font color="black">   6. #   Python Software Foundation License version 2</font>
<font color="black">   7. #</font>
<font color="black">   8. # See the file &quot;LICENSE&quot; for terms &amp; conditions for usage, and a DISCLAIMER OF</font>
<font color="black">   9. # ALL WARRANTIES.</font>
<font color="black">  10. #</font>
<font color="black">  11. # This Baseconv distribution contains no GNU General Public Licensed (GPLed)</font>
<font color="black">  12. # code so it may be used in proprietary projects just like prior ``baseconv``</font>
<font color="black">  13. # distributions.</font>
<font color="black">  14. #</font>
<font color="black">  15. # All trademarks referenced herein are property of their respective holders.</font>
<font color="black">  16. #</font>
<font color="black">  17. </font>
<font color="black">  18. &quot;&quot;&quot;</font>
<font color="black">  19. Convert numbers from base 10 integers to base X strings and back again.</font>
<font color="black">  20. </font>
<font color="black">  21. Sample usage::</font>
<font color="black">  22. </font>
<font color="black">  23.   &gt;&gt;&gt; base20 = BaseConverter('0123456789abcdefghij')</font>
<font color="black">  24.   &gt;&gt;&gt; base20.encode(1234)</font>
<font color="black">  25.   '31e'</font>
<font color="black">  26.   &gt;&gt;&gt; base20.decode('31e')</font>
<font color="black">  27.   1234</font>
<font color="black">  28.   &gt;&gt;&gt; base20.encode(-1234)</font>
<font color="black">  29.   '-31e'</font>
<font color="black">  30.   &gt;&gt;&gt; base20.decode('-31e')</font>
<font color="black">  31.   -1234</font>
<font color="black">  32.   &gt;&gt;&gt; base11 = BaseConverter('0123456789-', sign='$')</font>
<font color="black">  33.   &gt;&gt;&gt; base11.encode('$1234')</font>
<font color="black">  34.   '$-22'</font>
<font color="black">  35.   &gt;&gt;&gt; base11.decode('$-22')</font>
<font color="black">  36.   '$1234'</font>
<font color="black">  37. </font>
<font color="green">  38. &quot;&quot;&quot;</font>
<font color="black">  39. </font>
<font color="green">  40. BASE2_ALPHABET = '01'</font>
<font color="green">  41. BASE16_ALPHABET = '0123456789ABCDEF'</font>
<font color="green">  42. BASE56_ALPHABET = '23456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnpqrstuvwxyz'</font>
<font color="green">  43. BASE36_ALPHABET = '0123456789abcdefghijklmnopqrstuvwxyz'</font>
<font color="green">  44. BASE62_ALPHABET = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'</font>
<font color="green">  45. BASE64_ALPHABET = BASE62_ALPHABET + '-_'</font>
<font color="black">  46. </font>
<font color="black">  47. </font>
<font color="green">  48. class BaseConverter(object):</font>
<font color="green">  49.     decimal_digits = '0123456789'</font>
<font color="black">  50. </font>
<font color="green">  51.     def __init__(self, digits, sign='-'):</font>
<font color="green">  52.         self.sign = sign</font>
<font color="green">  53.         self.digits = digits</font>
<font color="green">  54.         if sign in self.digits:</font>
<font color="red">  55.             raise ValueError('Sign character found in converter base digits.')</font>
<font color="black">  56. </font>
<font color="green">  57.     def __repr__(self):</font>
<font color="red">  58.         return &quot;&lt;BaseConverter: base%s (%s)&gt;&quot; % (len(self.digits), self.digits)</font>
<font color="black">  59. </font>
<font color="green">  60.     def encode(self, i):</font>
<font color="red">  61.         neg, value = self.convert(i, self.decimal_digits, self.digits, '-')</font>
<font color="red">  62.         if neg:</font>
<font color="red">  63.             return self.sign + value</font>
<font color="red">  64.         return value</font>
<font color="black">  65. </font>
<font color="green">  66.     def decode(self, s):</font>
<font color="red">  67.         neg, value = self.convert(s, self.digits, self.decimal_digits, self.sign)</font>
<font color="red">  68.         if neg:</font>
<font color="red">  69.             value = '-' + value</font>
<font color="red">  70.         return int(value)</font>
<font color="black">  71. </font>
<font color="green">  72.     def convert(self, number, from_digits, to_digits, sign):</font>
<font color="red">  73.         if str(number)[0] == sign:</font>
<font color="red">  74.             number = str(number)[1:]</font>
<font color="red">  75.             neg = 1</font>
<font color="black">  76.         else:</font>
<font color="red">  77.             neg = 0</font>
<font color="black">  78. </font>
<font color="black">  79.         # make an integer out of the number</font>
<font color="red">  80.         x = 0</font>
<font color="red">  81.         for digit in str(number):</font>
<font color="red">  82.             x = x * len(from_digits) + from_digits.index(digit)</font>
<font color="black">  83. </font>
<font color="black">  84.         # create the result in base 'len(to_digits)'</font>
<font color="red">  85.         if x == 0:</font>
<font color="red">  86.             res = to_digits[0]</font>
<font color="black">  87.         else:</font>
<font color="red">  88.             res = ''</font>
<font color="red">  89.             while x &gt; 0:</font>
<font color="red">  90.                 digit = x % len(to_digits)</font>
<font color="red">  91.                 res = to_digits[digit] + res</font>
<font color="red">  92.                 x = int(x // len(to_digits))</font>
<font color="red">  93.         return neg, res</font>
<font color="black">  94. </font>
<font color="green">  95. base2 = BaseConverter(BASE2_ALPHABET)</font>
<font color="green">  96. base16 = BaseConverter(BASE16_ALPHABET)</font>
<font color="green">  97. base36 = BaseConverter(BASE36_ALPHABET)</font>
<font color="green">  98. base56 = BaseConverter(BASE56_ALPHABET)</font>
<font color="green">  99. base62 = BaseConverter(BASE62_ALPHABET)</font>
<font color="green"> 100. base64 = BaseConverter(BASE64_ALPHABET, sign='$')</font>
</pre>

